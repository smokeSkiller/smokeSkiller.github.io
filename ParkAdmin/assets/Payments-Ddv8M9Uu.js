import{_ as z,a as Pe,b as xe,P as Ae,d as j,c as De,e as Me}from"./vue-3-slider-component-lab0IWlZ.js";import{c as v,o as b}from"./modal-DRTCzFhK.js";import{g,o as C,s as Fe,w as d,a as s,b as i,t as G,d as c,_ as J,e as w,c as F,j as qe,F as K,u as e,x as L,z as Be,y as He}from"./index-iaVJZ9tw.js";import{k as Ie,O as Ne,T as Ve}from"./CustomOpenIndicator-DDrFPNUG.js";import{C as Ue}from"./CalculatedSummary-DJJDBlVZ.js";import{B as k}from"./BaseButton-CNUrt7E6.js";import{_ as Le}from"./close-icon-DcnZ6QH4.js";import{_ as ze,D as Ge,a as Je}from"./shift-icon-Dnx1g3Gh.js";import{_ as Ke}from"./summary-icon-BZQwzDv_.js";import{_ as Qe}from"./plus-icon-lxHPDhbU.js";import{T as We}from"./TableModal-DR_FmA9s.js";import{_ as D}from"./FormSelectField-DKGRwksg.js";import{u as Xe,_ as Ye}from"./usePayments-B8uZ46NC.js";import{u as Ze,O as _e}from"./useObjects-CCA0ScS_.js";import{u as M,_ as he}from"./useClients-CQLrztCb.js";import"./note-icon--KIhCtrW.js";import"./FilterSortDate-CuMhXrGb.js";import"./FormField-DFyU_dJ9.js";import"./SecondaryTable-8zNcad-4.js";import"./FilterSortSearch-SdFdygUQ.js";const et={__name:"PaymentsToolbar",props:{hasSelection:Boolean,selectedCount:Number,statusOptions:Array},emits:["deselect-all","delete-selected","open-mass-editor","change-status","calculate-summary"],setup(a,{emit:y}){const m=y;return(u,o)=>(C(),g(Ae,null,Fe({right:d(()=>[i(k,{class:"small-btn",onClick:o[5]||(o[5]=p=>m("open-settings"))},{default:d(()=>[...o[11]||(o[11]=[s("img",{src:Pe},null,-1)])]),_:1}),i(k,{class:"small-btn"},{default:d(()=>[...o[12]||(o[12]=[s("img",{src:xe},null,-1)])]),_:1})]),_:2},[a.hasSelection?{name:"left",fn:d(()=>[s("div",{class:"selected-count controller-item",onClick:o[0]||(o[0]=p=>m("deselect-all"))},[s("span",null,"Выбрано: "+G(a.selectedCount),1),i(k,{class:"btn-filled"},{default:d(()=>[...o[6]||(o[6]=[s("img",{src:Le},null,-1)])]),_:1})]),s("div",{class:"delete-row controller-item",onClick:o[1]||(o[1]=p=>m("delete-selected"))},[...o[7]||(o[7]=[s("img",{src:z},null,-1),c(" Удалить ",-1)])]),s("div",{class:"edit controller-item",onClick:o[2]||(o[2]=p=>m("open-mass-editor"))},[...o[8]||(o[8]=[s("img",{src:ze},null,-1),c(" Редактировать ",-1)])]),i(Ge,{class:"change-status controller-item","dropdown-list":a.statusOptions,onChange:o[3]||(o[3]=p=>m("change-status",p))},{default:d(()=>[...o[9]||(o[9]=[s("img",{src:Je},null,-1),c(" Изменить статус ",-1)])]),_:1},8,["dropdown-list"]),s("div",{class:"summary controller-item",onClick:o[4]||(o[4]=p=>m("calculate-summary"))},[...o[10]||(o[10]=[s("img",{src:Ke},null,-1),c(" Сумма ",-1)])])]),key:"0"}:void 0]),1024))}},tt={action:"#"},st=["onClick"],ot=Object.assign({inheritAttrs:!1},{__name:"PaymentsMassEditor",props:{tabs:Array,customClass:String,headerTitle:String,massEditorFields:Array,massEditorParams:Array},emits:["close-click","save-click","add-mass-editor-fields-row","remove-mass-editor-field"],setup(a,{expose:y,emit:m}){const u=m,o=w(null);return y({open:()=>o.value.open(),close:()=>o.value.close()}),(p,r)=>(C(),g(We,{tabs:a.tabs,"custom-class":a.customClass,"header-title":a.headerTitle,onSaveClick:r[1]||(r[1]=l=>u("save-click")),onCloseClick:r[2]||(r[2]=l=>u("close-click")),ref_key:"massEditorRef",ref:o},{edit:d(()=>[s("form",tt,[r[5]||(r[5]=s("h3",null,"Редактирование выбранных оплат",-1)),r[6]||(r[6]=s("div",{class:"d-flex"},[s("span",{class:"fields-label"},"Параметр"),s("span",{class:"fields-label"},"До изменения"),s("span",{class:"fields-label"},"После изменения")],-1)),(C(!0),F(K,null,qe(a.massEditorFields,(l,f)=>(C(),F("div",{class:"fields-row",key:f},[i(D,{options:a.massEditorParams,width:160},null,8,["options"]),i(D,{options:a.massEditorParams,width:160},null,8,["options"]),i(D,{options:a.massEditorParams,width:160},null,8,["options"]),s("button",{type:"button",class:"delete-row",onClick:T=>u("remove-mass-editor-field",f)},[...r[3]||(r[3]=[s("img",{src:z},null,-1)])],8,st)]))),128)),s("button",{type:"button",class:"add-fields-btn",onClick:r[0]||(r[0]=l=>u("add-mass-editor-fields-row"))},[...r[4]||(r[4]=[s("img",{src:Qe},null,-1),c(" Добавить изменения ",-1)])])])]),_:1},8,["tabs","custom-class","header-title"]))}}),nt=J(ot,[["__scopeId","data-v-baecf587"]]),lt={class:"w-100",style:{margin:"20px 0"}},it={class:"row refund-select"},rt=Object.assign({inheritAttrs:!1},{__name:"PaymentsRefund",props:{refundType:String,refundTypeOptions:Array},setup(a,{expose:y}){const m=a,u=w(null),o=w(m.refundType),p=w(!0);return y({open:()=>u.value.open(),close:()=>u.value.close()}),(r,l)=>(C(),g(j,{"custom-class":"refund-payment-popup","confirm-text":"Подтвердить возврат","cancel-text":"Отмена","disabled-confirm-btn":p.value,onCancel:l[2]||(l[2]=f=>e(v)(u.value)),onConfirm:l[3]||(l[3]=f=>console.log("Возврат подтвержден")),ref_key:"refundPopupRef",ref:u},{default:d(()=>[l[5]||(l[5]=s("h2",{class:"popup-title"},"Возврат денежных средств",-1)),l[6]||(l[6]=s("div",{class:"row"},[s("p",null,"Сумма к возврату"),s("p",null,[s("b",null,"450 ₽")])],-1)),l[7]||(l[7]=s("div",{class:"row"},[s("p",null,"Номер чека"),s("p",null,[s("b",null,"12345")])],-1)),s("div",lt,[s("div",it,[l[4]||(l[4]=s("p",null,"Причина возврата",-1)),i(e(Ie),{modelValue:o.value,"onUpdate:modelValue":[l[0]||(l[0]=f=>o.value=f),l[1]||(l[1]=f=>p.value=!1)],placeholder:"Выберите из списка",options:a.refundTypeOptions,clearable:!1,searchable:!1,components:{OpenIndicator:Ne}},null,8,["modelValue","options","components"])])]),l[8]||(l[8]=s("div",{class:"comment"},[s("label",{for:"refund-comment"},"Комментарий:"),s("textarea",{name:"refund-comment",id:"refund-comment"})],-1))]),_:1},8,["disabled-confirm-btn"]))}}),at={class:"page"},dt={class:"page-content"},mt={class:"popup-title"},ut={__name:"Payments",setup(a){const{paymentsStore:y,mainTableRef:m,tableHeader:u,tableContent:o,tableSettingsHeader:p,hasSelection:r,selectedCount:l,selectedRowsName:f,deleteSelectedPopupRef:T,tableSettingsRef:q,statusOptionsList:Q,showCalculatedSummary:O,summaryItems:W,massEditorRef:B,massEditorTabs:X,massEditorParams:Y,massEditorFields:H,paymentDetailsRef:I,refundPopupRef:N,refundType:Z,refundTypeOptions:_,savePopupRef:E,deleteSinglePopupRef:S,onSelectionChanged:h,deselectAll:V,openDeletePopup:ee,deleteSelected:te,saveConfirmClick:P,openMassEditor:se,addMassEditorFieldsRow:oe,changeTableSettings:ne,calculateSummaryItems:le}=Xe(),{objectEditorRef:R,objectEditorTabs:ie,objectEditorFields:re,objectEditorTableColumns:ae,objectEditorTableContent:de,objectHasEdited:U,addModalTableRow:me}=Ze(),{clientEditor:ue,clientEditorRef:$,requisitesTableRef:pt,financesHistoryTableRef:ft,docsTableRef:bt,editorTabs:pe,editorData:fe,clientHasEdited:be,editorContactColumns:ce,editorContactContent:ve,objectsId:ct,editorPinnedObjects:Ce,objectsAllNames:ye,showSearchObject:x,editorRequisitesColumns:Re,editorRequisitesContent:$e,finances:ke,financeHistoryColumns:ge,financeHistoryContent:Ee,reports:A,editorDocsColumns:Se,editorDocsContent:je,addReportsEmail:we,pinObject:Te,unpinObject:Oe}=M();return(vt,t)=>(C(),F(K,null,[s("main",at,[i(Ve,null,{default:d(()=>[i(k,{onClick:t[0]||(t[0]=n=>e(He).push("/sessions"))},{default:d(()=>[...t[28]||(t[28]=[c("Сессии",-1)])]),_:1}),i(k,{class:"btn-filled"},{default:d(()=>[...t[29]||(t[29]=[c("Оплаты",-1)])]),_:1})]),_:1}),s("div",dt,[e(O)?L("",!0):(C(),g(et,{key:0,"has-selection":e(r),"selected-count":e(l),"status-options":e(Q),onDeselectAll:e(V),onDeleteSelected:e(ee),onOpenMassEditor:e(se),onChangeStatus:t[1]||(t[1]=n=>console.log("Status:",n)),onCalculateSummary:e(le),onOpenSettings:t[2]||(t[2]=n=>e(b)(e(q)))},null,8,["has-selection","selected-count","status-options","onDeselectAll","onDeleteSelected","onOpenMassEditor","onCalculateSummary"])),e(O)?(C(),g(Ue,{key:1,"selected-text":`${e(l)} оплаты`,"title-text":"Данные по выбранным оплатам:",items:e(W),onReset:t[3]||(t[3]=n=>(O.value=!1,e(V)()))},null,8,["selected-text","items"])):L("",!0),i(De,{style:{"margin-top":"20px"},columns:e(u),data:e(o),onRowDblclick:t[4]||(t[4]=n=>e(b)(e(I))),onSelectionChanged:e(h),ref_key:"mainTableRef",ref:m},null,8,["columns","data","onSelectionChanged"])])]),i(Me,{"table-columns":e(p),onChange:t[5]||(t[5]=n=>e(ne)(n,e(y),e(m))),ref_key:"tableSettingsRef",ref:q},null,8,["table-columns"]),i(nt,{tabs:e(X),"custom-class":"mass-editor-modal","header-title":"Выбрано: 3","mass-editor-fields":e(H),"mass-editor-params":e(Y),onSaveClick:t[6]||(t[6]=n=>console.log("Changes saved!")),onCloseClick:t[7]||(t[7]=n=>e(v)(e(B))),onAddMassEditorFieldsRow:e(oe),onRemoveMassEditorField:t[8]||(t[8]=n=>e(H).splice(n,1)),ref_key:"massEditorRef",ref:B},null,8,["tabs","mass-editor-fields","mass-editor-params","onAddMassEditorFieldsRow"]),i(Ye,{"inner-width":"515","custom-class":"payment-details",onOpenObjectsEditor:t[9]||(t[9]=n=>e(b)(e(R))),onOpenClientsEditor:t[10]||(t[10]=n=>e(b)(e($))),onOpenRefundPopup:t[11]||(t[11]=n=>e(b)(e(N))),ref_key:"paymentDetailsRef",ref:I},null,512),i(he,{ref_key:"clientEditorRef",ref:$,"header-title":"Парковочный объект: “ТЦ Ромашка”",tabs:e(pe),"inner-width":870,"close-on-overlay-click":!1,"disabled-save-btn":!e(be),"editor-data":e(fe),"client-editor":e(ue),"editor-pinned-objects":e(Ce),"objects-all-names":e(ye),"show-search-object":e(x),"onUpdate:showSearchObject":t[12]||(t[12]=n=>Be(x)?x.value=n:null),finances:e(ke),reports:e(A),"editor-contact-columns":e(ce),"editor-contact-content":e(ve),"editor-requisites-columns":e(Re),"editor-requisites-content":e($e),"finance-history-columns":e(ge),"finance-history-content":e(Ee),"editor-docs-columns":e(Se),"editor-docs-content":e(je),onOverlayClick:t[13]||(t[13]=n=>e(b)(e(E))),onSaveClick:e(P),onCloseClick:t[14]||(t[14]=n=>e(v)(e($))),onAddContactRow:t[15]||(t[15]=n=>e(M)().addTableRow(e($).contactsTable)),onAddRequisitesRow:t[16]||(t[16]=n=>e(M)().addTableRow(e($).requisitesTable)),onPinObject:e(Te),onUnpinObject:e(Oe),onAddReportsEmail:e(we),onOpenObjectEditor:t[17]||(t[17]=n=>e(b)(e(R))),onToggleEmailField:t[18]||(t[18]=n=>e(A).showEmailField=n),onRemoveReportEmail:t[19]||(t[19]=n=>e(A).emailsToSend.splice(n,1))},null,8,["tabs","disabled-save-btn","editor-data","client-editor","editor-pinned-objects","objects-all-names","show-search-object","finances","reports","editor-contact-columns","editor-contact-content","editor-requisites-columns","editor-requisites-content","finance-history-columns","finance-history-content","editor-docs-columns","editor-docs-content","onSaveClick","onPinObject","onUnpinObject","onAddReportsEmail"]),i(_e,{"header-title":"Парковочный объект: “ТЦ Ромашка”",tabs:e(ie),"inner-width":870,"close-on-overlay-click":!1,"disabled-save-btn":!e(U),"object-has-edited":e(U),"object-editor-fields":e(re),"object-editor-table-columns":e(ae),"object-editor-table-content":e(de),onOverlayClick:t[20]||(t[20]=n=>e(b)(e(E))),onSaveClick:e(P),onCloseClick:t[21]||(t[21]=n=>e(v)(e(R))),onAddModalTableRow:t[22]||(t[22]=n=>e(me)(e(R).contactsTable)),onOpenDeletePopup:t[23]||(t[23]=n=>e(b)(e(S))),ref_key:"objectEditorRef",ref:R},null,8,["tabs","disabled-save-btn","object-has-edited","object-editor-fields","object-editor-table-columns","object-editor-table-content","onSaveClick"]),i(j,{ref_key:"deleteSelectedPopupRef",ref:T,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:e(te),onCancel:t[24]||(t[24]=n=>e(v)(e(T)))},{default:d(()=>[s("h2",mt,[t[30]||(t[30]=c(" Удалить сессии? ",-1)),t[31]||(t[31]=s("br",null,null,-1)),c(" "+G(e(f)),1)])]),_:1},8,["onConfirm"]),i(rt,{"custom-class":"refund-payment-popup","refund-type":e(Z),"refund-type-options":e(_),ref_key:"refundPopupRef",ref:N},null,8,["refund-type","refund-type-options"]),i(j,{ref_key:"savePopupRef",ref:E,"confirm-text":"Сохранить","cancel-text":"Не сохранять",onCancel:t[25]||(t[25]=n=>e(v)(e(E))),onConfirm:e(P)},{default:d(()=>[...t[32]||(t[32]=[s("h2",{class:"popup-title"},"Сохранить перед выходом?",-1),s("p",{class:"popup-text"},"Без сохранения все изменения будут потеряны!",-1)])]),_:1},8,["onConfirm"]),i(j,{ref_key:"deleteSinglePopupRef",ref:S,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:t[26]||(t[26]=n=>e(v)(e(S))),onCancel:t[27]||(t[27]=n=>e(v)(e(S)))},{default:d(()=>[...t[33]||(t[33]=[s("h2",{class:"popup-title"}," Удалить объект? ",-1)])]),_:1},512)],64))}},Ht=J(ut,[["__scopeId","data-v-03f23406"]]);export{Ht as default};
