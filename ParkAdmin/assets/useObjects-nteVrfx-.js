import{_ as I,c as g,u as D}from"./vue-3-slider-component-DVLLiOr3.js";import{T as Z}from"./TableModal-p6TpcjEn.js";import{B as C}from"./BaseButton-BUPZcaam.js";import{F as E}from"./FormField-5cKzPise.js";import{_ as b}from"./FormSelectField-BrAB1vmC.js";import{_ as z}from"./SecondaryTable-DySUWM44.js";import{_ as W,e as u,g as L,o as R,w as f,b as d,a as l,d as v,y as j,z as q,i as k}from"./index-BWF_qH93.js";import{o as G,c as J}from"./modal-DRTCzFhK.js";import{b as O,u as K}from"./useObjectsEditor-1kBT4oY3.js";import{_ as Q}from"./FilterSortSearch-CQoBWqkz.js";import{_ as X}from"./FilterSortDate-CPNclfv2.js";const Y={action:"#"},h={class:"fields-group"},_={class:"field-outer"},ee={class:"fields-group"},te={class:"field-outer"},oe={class:"fields-group"},le={class:"field-outer"},se={class:"field-outer"},ne={class:"fields-group"},ae={class:"field-outer"},ie={class:"field-outer"},de=Object.assign({inheritAttrs:!1},{__name:"ObjectsEditor",props:{headerTitle:String,tabs:Array,innerWidth:Number,closeOnOverlayClick:Boolean,disabledSaveBtn:Boolean,objectHasEdited:Boolean,objectEditorFields:Array,objectEditorTableColumns:Array,objectEditorTableContent:Array},emits:["overlay-click","save-click","close-click","add-modal-table-row","open-delete-popup"],setup(t,{expose:n,emit:c}){const a=c,i=u(null),s=u(null);return n({contactsTable:s,open:()=>i.value.open(),close:()=>i.value.close()}),(m,e)=>(R(),L(Z,{"header-title":t.headerTitle,tabs:t.tabs,"inner-width":t.innerWidth,"close-on-overlay-click":!1,"disabled-save-btn":!t.objectHasEdited,onOverlayClick:e[13]||(e[13]=o=>a("overlay-click")),onSaveClick:e[14]||(e[14]=o=>a("save-click")),onCloseClick:e[15]||(e[15]=o=>a("close-click")),ref_key:"objectEditorRef",ref:i},{data:f(()=>[l("form",Y,[e[22]||(e[22]=l("h3",null,"Данные о компании",-1)),l("div",h,[d(E,{items:t.objectEditorFields.clients,name:"client",modelValue:t.objectEditorFields.client,"onUpdate:modelValue":e[0]||(e[0]=o=>t.objectEditorFields.client=o),label:"Клиент"},null,8,["items","modelValue"]),d(E,{name:"object",modelValue:t.objectEditorFields.object,"onUpdate:modelValue":e[1]||(e[1]=o=>t.objectEditorFields.object=o),label:"Объект"},null,8,["modelValue"]),l("div",_,[e[16]||(e[16]=l("label",null,"Статус",-1)),d(b,{modelValue:t.objectEditorFields.status,"onUpdate:modelValue":e[2]||(e[2]=o=>t.objectEditorFields.status=o),options:t.objectEditorFields.statusOptions},null,8,["modelValue","options"])]),d(E,{name:"domain",modelValue:t.objectEditorFields.domain,"onUpdate:modelValue":e[3]||(e[3]=o=>t.objectEditorFields.domain=o),label:"Домен объекта"},null,8,["modelValue"])]),l("div",ee,[l("div",te,[e[17]||(e[17]=l("label",null,[v("Фиск. "),l("br"),v(" сервис")],-1)),d(b,{modelValue:t.objectEditorFields.fiscalService,"onUpdate:modelValue":e[4]||(e[4]=o=>t.objectEditorFields.fiscalService=o),options:t.objectEditorFields.fiscalServices,name:"fiscal-service"},null,8,["modelValue","options"])]),d(E,{name:"check-email",modelValue:t.objectEditorFields.checkEmail,"onUpdate:modelValue":e[5]||(e[5]=o=>t.objectEditorFields.checkEmail=o),label:"E-mail <br> для чеков"},null,8,["modelValue"])]),l("div",oe,[l("div",le,[e[18]||(e[18]=l("label",null,"Страна",-1)),d(b,{modelValue:t.objectEditorFields.country,"onUpdate:modelValue":e[6]||(e[6]=o=>t.objectEditorFields.country=o),options:t.objectEditorFields.countries,name:"country"},null,8,["modelValue","options"])]),d(E,{name:"address",modelValue:t.objectEditorFields.address,"onUpdate:modelValue":e[7]||(e[7]=o=>t.objectEditorFields.address=o),label:"Адрес"},null,8,["modelValue"]),l("div",se,[e[19]||(e[19]=l("label",null,"Час. пояс",-1)),d(b,{modelValue:t.objectEditorFields.timeZone,"onUpdate:modelValue":e[8]||(e[8]=o=>t.objectEditorFields.timeZone=o),options:t.objectEditorFields.timeZones,name:"timezone"},null,8,["modelValue","options"])])]),l("div",ne,[l("div",ae,[e[20]||(e[20]=l("label",null,"Валюта",-1)),d(b,{modelValue:t.objectEditorFields.currency,"onUpdate:modelValue":e[9]||(e[9]=o=>t.objectEditorFields.currency=o),options:t.objectEditorFields.currencies,name:"currency"},null,8,["modelValue","options"])]),l("div",ie,[e[21]||(e[21]=l("label",null,"Язык",-1)),d(b,{modelValue:t.objectEditorFields.lang,"onUpdate:modelValue":e[10]||(e[10]=o=>t.objectEditorFields.lang=o),options:t.objectEditorFields.langs,name:"lang"},null,8,["modelValue","options"])])])])]),contact:f(()=>[e[24]||(e[24]=l("h3",null,"Контактные лица",-1)),d(z,{style:{"margin-top":"20px"},columns:t.objectEditorTableColumns,data:t.objectEditorTableContent,ref_key:"objectContactsTableRef",ref:s},null,8,["columns","data"]),d(C,{style:{"margin-top":"20px"},onClick:e[11]||(e[11]=o=>a("add-modal-table-row"))},{default:f(()=>[...e[23]||(e[23]=[v("Добавить",-1)])]),_:1})]),"sidebar-bottom":f(()=>[d(C,{class:"remove-object-btn",onClick:e[12]||(e[12]=o=>a("open-delete-popup"))},{default:f(()=>[...e[25]||(e[25]=[l("img",{src:I},null,-1),v(" Удалить объект ",-1)])]),_:1})]),_:1},8,["header-title","tabs","inner-width","disabled-save-btn"]))}}),Se=W(de,[["__scopeId","data-v-c46197da"]]);function re(){return{applyFiltersToColumns:(n,c,a)=>c.map(i=>i.field==="name"?{...i,headerClickPopup(){const s=document.createElement("div");return j(g,{onSelectSortOrder(){a(n,"name")}}).mount(s),s}}:i.field==="geopos"?{...i,headerClickPopup(){const s=document.createElement("div");return j(g,{onSelectSortOrder(){a(n,"geopos")}}).mount(s),s}}:i.field==="country"?{...i,headerClickPopup(){const s=document.createElement("div");return j(X,{onSelectSortOrder(){a(n,"country")},onSelectCompareState(){a(n,"country")},onSelectDate(){a(n,"country")},onSelectDateRange(){a(n,"country")}}).mount(s),s}}:i.field==="city"?{...i,headerClickPopup(){const s=document.createElement("div");return j(Q,{onSelectSortOrder(){a(n,"city")},dropdownItems:[{name:"Пенза"},{name:"Мосва"},{name:"Самара"},{name:"Екатеринбург"},{name:"Кемерово"}],onSelectCheckbox(){a(n,"city")}}).mount(s),s}}:i)}}function ue(t){const n=O(),c=u(null),a=u([{name:"edit",label:"Массовое редактирование"}]),i=u(n.massEditor.params),s=q([{}]);return{massEditorRef:c,massEditorTabs:a,massEditorParams:i,massEditorFields:s,openMassEditor:()=>t.openMassEditor(c),addMassEditorFieldsRow:()=>t.addMassEditorFieldsRow(s)}}function ge(){const t=O(),n=D(),{hasSelection:c,selectedCount:a,selectedRows:i,selectedRowsName:s,changeTableSettings:m,addResetFilterBtn:e}=n,o=u(null),p=k(()=>t.mainTable.columns),T=k(()=>t.mainTable.content),w=u(null),U=p.value.filter(r=>r.formatter!=="rowSelection").map(r=>({field:r.field,title:r.title})),V=u(null),M=u([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:$}=re();t.mainTable.columns=$(o,p.value,e);const x=K(),A=ue(n),y=u([]),F=u(!1),P=()=>n.deselectAll(o),N=()=>n.deleteSelected(o,()=>J(V.value)),B=()=>G(V.value),H=r=>{n.onSelectionChanged(r,"name"),F.value&&S()},S=()=>{F.value=!0,y.value=i.value.map(r=>({name:r.name,average_length:r.average_length,average_sum:r.average_sum,total_sum:r.total_sum}))};return{objectsStore:t,mainTableRef:o,tableHeader:p,tableContent:T,tableSettingsHeader:U,hasSelection:c,selectedCount:a,selectedRows:i,selectedRowsName:s,deleteSelectedPopupRef:V,tableSettingsRef:w,statusOptionsList:M,showCalculatedSummary:F,summaryItems:y,...x,...A,onSelectionChanged:H,deselectAll:P,deleteSelected:N,changeTableSettings:m,calculateSummaryItems:S,openDeletePopup:B}}export{Se as O,ge as u};
