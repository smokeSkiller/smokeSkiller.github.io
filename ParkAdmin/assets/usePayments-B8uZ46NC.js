import{n as w,m as v}from"./note-icon--KIhCtrW.js";import{B as H}from"./BaseButton-CNUrt7E6.js";import{B as W,f as z,u as U}from"./vue-3-slider-component-lab0IWlZ.js";import{c as C,o as q}from"./modal-DRTCzFhK.js";import{e as l,g as G,o as J,w as b,a as e,b as K,d as Q,u as X,A as Y,B as S,C as Z,i as k}from"./index-iaVJZ9tw.js";import{_}from"./FilterSortDate-CuMhXrGb.js";const ee={class:"content-inner"},te={class:"box"},se={class:"row"},ne={class:"d-flex align-items-center"},le={class:"row"},ae={class:"d-flex align-items-center"},fe=Object.assign({inheritAttrs:!1},{__name:"PaymentsDetails",props:{innerWidth:Number,customClass:String},emits:["open-objects-editor","open-clients-editor","open-refund-popup"],setup(n,{expose:s,emit:i}){const o=i,a=l(null);return s({open:()=>a.value.open(),close:()=>a.value.close()}),(r,t)=>(J(),G(W,{"inner-width":n.innerWidth,"custom-class":n.customClass,ref_key:"paymentDetailsRef",ref:a},{header:b(()=>[t[5]||(t[5]=e("h2",{class:"title"},"Детали оплаты, чек №0013",-1)),e("button",{class:"close-btn",onClick:t[0]||(t[0]=d=>X(C)(a.value))},[...t[4]||(t[4]=[e("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.668 10.6667L21.3346 21.3334",stroke:"black","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M21.332 10.6667L10.6654 21.3334",stroke:"black","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),body:b(()=>[e("div",ee,[t[19]||(t[19]=e("div",{class:"top-box"},[e("p",null,[e("b",null,"60 000 ₽, 6.05.24, 08:15:05")])],-1)),e("div",te,[t[12]||(t[12]=e("div",{class:"row"},[e("p",null,"Сумма"),e("div",{class:"d-flex align-items-center"},[e("p",null,[e("b",null,"60 000 ₽")]),e("button",{class:"icon copy-icon"},[e("img",{src:w})])])],-1)),t[13]||(t[13]=e("div",{class:"row row-error"},[e("p",null,"Дата и время"),e("div",{class:"d-flex align-items-center"},[e("p",null,[e("b",null,"15.05.24, 12:01:05")])])],-1)),t[14]||(t[14]=e("div",{class:"row"},[e("p",null,"№ сессии"),e("p",null,[e("b",null,"1665423547316996")])],-1)),t[15]||(t[15]=e("div",{class:"row"},[e("p",null,"Тип оплаты"),e("p",null,[e("b",null,"Разовый въезд")])],-1)),t[16]||(t[16]=e("div",{class:"row"},[e("p",null,"Статус"),e("p",null,[e("b",null,"Успешно")])],-1)),e("div",se,[t[8]||(t[8]=e("p",null,"Объект",-1)),e("div",ne,[t[7]||(t[7]=e("p",null,[e("b",null,"ТЦ “Ромашка”")],-1)),e("button",{class:"icon link-icon",onClick:t[1]||(t[1]=d=>o("open-objects-editor"))},[...t[6]||(t[6]=[e("img",{src:v},null,-1)])])])]),e("div",le,[t[11]||(t[11]=e("p",null,"Клиент",-1)),e("div",ae,[t[10]||(t[10]=e("p",null,[e("b",null,"ООО “Шишмаойл”")],-1)),e("button",{class:"icon link-icon",onClick:t[2]||(t[2]=d=>o("open-clients-editor"))},[...t[9]||(t[9]=[e("img",{src:v},null,-1)])])])]),t[17]||(t[17]=e("div",{class:"row"},[e("p",null,"ID пользователя"),e("div",{class:"d-flex align-items-center"},[e("p",null,[e("b",null,"09087754")]),e("button",{class:"icon link-icon"},[e("img",{src:v})])])],-1))]),K(H,{class:"refund-btn btn-filled",onClick:t[3]||(t[3]=d=>o("open-refund-popup"))},{default:b(()=>[...t[18]||(t[18]=[Q(" Оформить возврат ",-1)])]),_:1})])]),_:1},8,["inner-width","custom-class"]))}}),x=Y("payments",{state:()=>({mainTable:{columns:[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,width:30},{field:"sum",title:"Сумма",headerSort:!1,formatter:function(n){return`${n.getValue().toLocaleString("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(/,/g,".")} ₽`}},{field:"id",title:"№ Сессии",headerSort:!1,width:150},{field:"payment-time",title:"Время оплаты",headerSort:!1},{field:"payment-type",title:"Тип оплаты",headerSort:!1},{field:"check",title:"Чек",headerSort:!1,formatter:function(n){return`
                            <div class="check-cell">
                                <span>${n.getValue()}</span>
                                <button class="check-btn">
                                    <img src="${w}" />
                                </button>
                            </div>
                        `},cellClick:(n,s)=>{if(n.target.closest(".check-btn")){const i=s.getValue();console.log("Нажали на кнопку чека:",i)}}},{field:"status",title:"Статус",headerSort:!1,width:160,formatter:function(n){const s=n.getValue();return{paid:'<span class="status status-paid">Успешно</span>',refunded:'<span class="status status-canceled">Возвращён</span>',canceled:'<span class="status status-canceled">Отменена</span>'}[s]??s}}],content:[{sum:450,id:1,"payment-time":"15.05.24 12:01:05","payment-type":"Разовый въезд",check:"0012",status:"paid"},{sum:6e4,id:2,"payment-time":"16.05.24 08:53:42","payment-type":"Абонемент",check:"0014",status:"canceled"},{sum:1200,id:3,"payment-time":"17.05.24 14:34:53","payment-type":"ParkPass",check:"0013",status:"refunded"},{sum:700,id:4,"payment-time":"15.05.24 12:01:05","payment-type":"Разовый въезд",check:"0012",status:"paid"},{sum:23e3,id:5,"payment-time":"16.05.24 08:53:42","payment-type":"Абонемент",check:"0014",status:"paid"},{sum:2100,id:6,"payment-time":"17.05.24 14:34:53","payment-type":"ParkPass",check:"0013",status:"refunded"}]},massEditor:{params:[{label:"№ Сессии",value:"session-id"},{label:"Объект",value:"object-name"},{label:"Номер ТС",value:"vehicle-number"},{label:"Время въезда",value:"enter-time"},{label:"Время выезда",value:"exit-time"},{label:"Длительность",value:"duration"},{label:"Сумма",value:"total"},{label:"Статус",value:"status"}]}})});function oe(){return{applyFiltersToColumns:(s,i,o)=>i.map(a=>a.field==="id"?{...a,headerClickPopup(){const r=document.createElement("div");return S(z,{onSelectSortOrder(){o(s,"id")}}).mount(r),r}}:a.field==="payment-time"?{...a,headerClickPopup(){const r=document.createElement("div");return S(_,{onSelectSortOrder(){o(s,"payment-time")},onSelectCompareState(){o(s,"payment-time")},onSelectDate(){o(s,"payment-time")},onSelectDateRange(){o(s,"payment-time")}}).mount(r),r}}:a)}}function ie(n){const s=x(),i=l(null),o=l([{name:"edit",label:"Массовое редактирование"}]),a=l(s.massEditor.params),r=Z([{}]);return{massEditorRef:i,massEditorTabs:o,massEditorParams:a,massEditorFields:r,openMassEditor:()=>n.openMassEditor(i),addMassEditorFieldsRow:()=>n.addMassEditorFieldsRow(r)}}function ve(){const n=x(),s=U(),{hasSelection:i,selectedCount:o,selectedRows:a,selectedRowsName:r,changeTableSettings:t,addResetFilterBtn:d}=s,m=l(null),p=k(()=>n.mainTable.columns),P=k(()=>n.mainTable.content),E=l(null),h=p.value.filter(u=>u.formatter!=="rowSelection").map(u=>({field:u.field,title:u.title})),c=l(null),M=l([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:D}=oe();n.mainTable.columns=D(m,p.value,d);const R=ie(s),y=l([]),f=l(!1),T=l(null),V=l(null),$=l(""),A=[{value:"tech-issue",label:"Техническая ошибка"},{value:"payment-issue",label:"Ошибка при оплате"},{value:"another-issue",label:"Другое"}],F=l(!0),B=l(null),j=l(null);const N=()=>s.deselectAll(m),O=()=>s.deleteSelected(m,()=>C(c.value)),I=()=>q(c.value),L=u=>{s.onSelectionChanged(u,"id"),f.value&&g()},g=()=>{f.value=!0,y.value=a.value.map(u=>({name:u["payment-type"],average_sum:u.sum,total_sum:u.sum}))};return{paymentsStore:n,mainTableRef:m,tableHeader:p,tableContent:P,tableSettingsHeader:h,savePopupRef:B,saveNotifyRef:j,hasSelection:i,selectedCount:o,selectedRows:a,selectedRowsName:r,deleteSelectedPopupRef:c,tableSettingsRef:E,statusOptionsList:M,showCalculatedSummary:f,summaryItems:y,paymentDetailsRef:T,refundPopupRef:V,refundType:$,refundTypeOptions:A,refundConfirmDisabled:F,...R,onSelectionChanged:L,deselectAll:N,calculateSummaryItems:g,deleteSelected:O,changeTableSettings:t,openDeletePopup:I}}export{fe as _,ve as u};
