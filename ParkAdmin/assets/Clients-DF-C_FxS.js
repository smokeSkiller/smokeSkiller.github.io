import{g as j,_ as X,a as ie,u as re,T as de,P as ue,b as me,d as Y,c as I,e as ce,f as pe,h as fe,D as ve,i as ge,l as ee,j as be,k as Ce,F}from"./FilterSortDate-DwA6o7ns.js";import{B as Se,_ as ye}from"./BottomNotify-CK2KQ3FM.js";import{B as w}from"./BaseButton-BJgVlfLN.js";import{_ as we,a as ke,F as H}from"./FilterSortSearch-BEreCfIb.js";import{c as b,o as T}from"./modal-DRTCzFhK.js";import{s as Ee,x as U,e as m,i as B,y as Re,_ as Te,c as L,a as l,b as s,w as d,A as Pe,u as t,F as te,o as Z,d as v,t as le,j as _e}from"./index-Ye-EomIF.js";const xe="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M1.5%208C1.5%204.41015%204.41015%201.5%208%201.5C11.5899%201.5%2014.5%204.41015%2014.5%208C14.5%2011.5899%2011.5899%2014.5%208%2014.5H2.57143C1.9797%2014.5%201.5%2014.0203%201.5%2013.4286V8ZM8%202.5C4.96243%202.5%202.5%204.96243%202.5%208V13.4286C2.5%2013.468%202.53198%2013.5%202.57143%2013.5H8C11.0376%2013.5%2013.5%2011.0376%2013.5%208C13.5%204.96243%2011.0376%202.5%208%202.5Z'%20fill='%23343434'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.83333%206C4.83333%205.72386%205.05719%205.5%205.33333%205.5H10C10.2761%205.5%2010.5%205.72386%2010.5%206C10.5%206.27614%2010.2761%206.5%2010%206.5H5.33333C5.05719%206.5%204.83333%206.27614%204.83333%206Z'%20fill='%23343434'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.83333%208C4.83333%207.72386%205.05719%207.5%205.33333%207.5H10C10.2761%207.5%2010.5%207.72386%2010.5%208C10.5%208.27614%2010.2761%208.5%2010%208.5H5.33333C5.05719%208.5%204.83333%208.27614%204.83333%208Z'%20fill='%23343434'/%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M4.83333%2010C4.83333%209.72386%205.05719%209.5%205.33333%209.5H7.33333C7.60948%209.5%207.83333%209.72386%207.83333%2010C7.83333%2010.2761%207.60948%2010.5%207.33333%2010.5H5.33333C5.05719%2010.5%204.83333%2010.2761%204.83333%2010Z'%20fill='%23343434'/%3e%3c/svg%3e",z=Ee("clients",{state:()=>({mainTable:{columns:[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,width:30},{field:"name",title:"Название",headerSort:!1,width:140},{field:"geopos",title:"Геопозиция",headerSort:!1,width:150},{field:"country",title:"Страна",headerSort:!1,width:120},{field:"city",title:"Город",headerSort:!1,width:120},{field:"address",title:"Адрес",headerSort:!1},{field:"status",title:"Статус",headerSort:!1,width:160},{field:"lang",title:"Язык",headerSort:!1,width:120},{field:"currency",title:"Валюта",headerSort:!1,width:120},{field:"pp",title:"%PP",headerSort:!1,width:120},{field:"commission",title:"Комиссия",headerSort:!1}],content:[{id:1,name:"ТЦ Ромашка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:670,average_sum:340},{id:2,name:"ТЦ Метрополис",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:7e3,average_length:265,average_sum:775},{id:3,name:"ТЦ Таганка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:11e3,average_length:560,average_sum:900},{id:4,name:"ТЦ Лорисы",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:8e3,average_length:654,average_sum:340},{id:5,name:"ТЦ Долиной",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:1e4,average_length:344,average_sum:775},{id:6,name:"ТЦ Хата",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:455,average_sum:900}]},clientEditor:{tabs:[{name:"data",label:"Общая информация"},{name:"contact",label:"Контактные лица"},{name:"objects",label:"Объекты"},{name:"requisites",label:"Реквизиты"},{name:"finances",label:"Финансы"},{name:"reports",label:"Отчёты"},{name:"docs",label:"Документы"}],dataFields:{name:"ООО Промкреп",phone:"+7 987 650-18-32",email:"promkrep@yandex.ru",address:"г. Москва, ул. Салютовская 6а",status:"active",statusOptions:[{label:"Действующий",value:"active"},{label:"Отключен",value:"disabled"}]},contacts:{columns:[{field:"name",title:"ФИО",width:121,headerSort:!1,editor:"input"},{field:"position",title:"Должность",width:98,headerSort:!1,editor:"input"},{field:"phone",title:"Телефон",headerSort:!1,editor:"input",editorParams:{mask:"+7 (999) 999-99-99",selectContents:!0,maskAutoFill:!0}},{field:"email",title:"E-mail",headerSort:!1,editor:"input"},{title:"",field:"actions",hozAlign:"center",headerSort:!1,width:60,formatter:function(){return`
                  <div class="table-action">
                    <img src="${xe}" class="comment-btn" />
                    <img src="${j}" class="delete-btn" />
                  </div>
                `},cellClick:function(u,n){const c=n.getRow();u.target.classList.contains("comment-btn")&&console.log(n.getTable()),u.target.classList.contains("delete-btn")&&c.delete()}}],content:[{name:"Петров Виктор Сидорович",position:"Ген.директор",phone:"+7 (495) 123-45-67",email:"petrov.vs@centercity.ru",comment:""},{name:"Сидорова Анна Михайловна",position:"Главный инженер",phone:"+7 (916) 100-20-30",email:"sidorova.am@city.ru",comment:""},{name:"Ковалев Игорь Дмитриевич",position:"Менеджер парковки",phone:"+7 (495) 123-45-67",email:"kovalev.id@centercity.ru",comment:""}]}},massEditor:{params:[{label:"Геопозиция",value:"geopos"},{label:"Страна",value:"country"},{label:"Город",value:"city"},{label:"Адрес",value:"address"},{label:"Статус",value:"status"},{label:"Язык",value:"lang"},{label:"Валюта",value:"currency"},{label:"%PP",value:"pp"},{label:"Комиссия",value:"commission"}]}})});function Me(){return{applyFiltersToColumns:(n,c,r)=>c.map(a=>a.field==="name"?{...a,headerClickPopup(){const i=document.createElement("div");return U(X,{onSelectSortOrder(){r(n,"name")}}).mount(i),i}}:a.field==="geopos"?{...a,headerClickPopup(){const i=document.createElement("div");return U(X,{onSelectSortOrder(){r(n,"geopos")}}).mount(i),i}}:a.field==="country"?{...a,headerClickPopup(){const i=document.createElement("div");return U(ie,{onSelectSortOrder(){r(n,"country")},onSelectCompareState(){r(n,"country")},onSelectDate(){r(n,"country")},onSelectDateRange(){r(n,"country")}}).mount(i),i}}:a.field==="city"?{...a,headerClickPopup(){const i=document.createElement("div");return U(we,{onSelectSortOrder(){r(n,"city")},dropdownItems:[{name:"Пенза"},{name:"Мосва"},{name:"Самара"},{name:"Екатеринбург"},{name:"Кемерово"}],onSelectCheckbox(){r(n,"city")}}).mount(i),i}}:a)}}function Ve(){const u=z(),n=m(null),c=m(null),r=m(null),a=m(null),i=m(null),g=m(u.clientEditor.tabs),k=B(()=>u.clientEditor.dataFields),C=u.clientEditor.contacts.columns,S=u.clientEditor.contacts.content;return{clientEditorRef:n,contactsTableRef:c,savePopupRef:r,saveNotifyRef:a,deleteSinglePopupRef:i,clientEditorTabs:g,clientEditorData:k,clientEditorTableColumns:C,clientEditorTableContent:S,saveConfirmClick:()=>{b(r.value),T(a.value),setTimeout(()=>b(a.value),3e3)},cancelSaveClick:()=>{b(r.value),b(n.value)},addModalTableRow:()=>{c.value.getTable()?.addRow({id:Date.now(),name:"",status:"new"})}}}function $e(u){const n=z(),c=m(null),r=m([{name:"edit",label:"Массовое редактирование"}]),a=m(n.massEditor.params),i=Re([{}]);return{massEditorRef:c,massEditorTabs:r,massEditorParams:a,massEditorFields:i,openMassEditor:()=>u.openMassEditor(c),addMassEditorFieldsRow:()=>u.addMassEditorFieldsRow(i)}}function Fe(){const u=z(),n=re(),{hasSelection:c,selectedCount:r,selectedRows:a,selectedRowsName:i,changeTableSettings:g,addResetFilterBtn:k}=n,C=m(null),S=B(()=>u.mainTable.columns),E=B(()=>u.mainTable.content),P=m(null),M=S.value.filter(f=>f.formatter!=="rowSelection").map(f=>({field:f.field,title:f.title})),R=m(null),D=m([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:V}=Me();u.mainTable.columns=V(C,S.value,k);const h=Ve(),_=$e(n),x=m([]),y=m(!1),A=()=>n.deselectAll(C),N=()=>n.deleteSelected(C,()=>b(R.value)),p=()=>T(R.value),O=f=>{n.onSelectionChanged(f,"name"),y.value&&$()},$=()=>{y.value=!0,x.value=a.value.map(f=>({name:f.name,average_length:f.average_length,average_sum:f.average_sum,total_sum:f.total_sum}))};return{clientsStore:u,mainTableRef:C,tableHeader:S,tableContent:E,tableSettingsHeader:M,hasSelection:c,selectedCount:r,selectedRows:a,selectedRowsName:i,deleteSelectedPopupRef:R,tableSettingsRef:P,statusOptionsList:D,showCalculatedSummary:y,summaryItems:x,...h,..._,onSelectionChanged:O,deselectAll:A,deleteSelected:N,changeTableSettings:g,calculateSummaryItems:$,openDeletePopup:p}}const He={class:"page"},Ue={class:"page-content"},De={action:"#"},he={class:"fields-group"},Ae={class:"field-outer"},Ne={class:"contact-table-outer"},Oe={action:"#"},Ie=["onClick"],Le={class:"popup-title"},Ze={__name:"Clients",setup(u){const{clientsStore:n,mainTableRef:c,tableHeader:r,tableContent:a,tableSettingsHeader:i,hasSelection:g,selectedCount:k,selectedRowsName:C,deleteSelectedPopupRef:S,deleteSinglePopupRef:E,savePopupRef:P,saveNotifyRef:M,tableSettingsRef:R,statusOptionsList:D,massEditorRef:V,massEditorTabs:h,massEditorParams:_,massEditorFields:x,clientEditorRef:y,contactsTableRef:A,clientEditorTabs:N,clientEditorData:p,clientEditorTableColumns:O,clientEditorTableContent:$,onSelectionChanged:f,deselectAll:q,openDeletePopup:G,deleteSelected:oe,saveConfirmClick:J,cancelSaveClick:se,openMassEditor:K,addModalTableRow:ne,addMassEditorFieldsRow:Q,changeTableSettings:ae}=Fe();return(je,e)=>(Z(),L(te,null,[l("main",He,[s(de,null,{default:d(()=>[s(w,{class:"btn-filled"},{default:d(()=>[...e[21]||(e[21]=[v("Клиенты",-1)])]),_:1}),s(w,null,{default:d(()=>[...e[22]||(e[22]=[v("Финансы",-1)])]),_:1})]),_:1}),l("div",Ue,[s(ue,null,Pe({right:d(()=>[s(w,{class:"btn-filled add-element-btn",onClick:e[4]||(e[4]=o=>t(T)(t(y)))},{default:d(()=>[...e[27]||(e[27]=[l("img",{src:ee},null,-1),v(" Добавить клиента ",-1)])]),_:1}),s(w,{class:"small-btn",onClick:e[5]||(e[5]=o=>t(T)(t(R)))},{default:d(()=>[...e[28]||(e[28]=[l("img",{src:be},null,-1)])]),_:1}),s(w,{class:"small-btn"},{default:d(()=>[...e[29]||(e[29]=[l("img",{src:Ce},null,-1)])]),_:1})]),_:2},[t(g)==!0?{name:"left",fn:d(()=>[l("div",{class:"selected-count controller-item",onClick:e[0]||(e[0]=(...o)=>t(q)&&t(q)(...o))},[l("span",null,"Выбрано: "+le(t(k)),1),s(w,{class:"btn-filled"},{default:d(()=>[...e[23]||(e[23]=[l("img",{src:pe},null,-1)])]),_:1})]),l("div",{class:"delete-row controller-item",onClick:e[1]||(e[1]=(...o)=>t(G)&&t(G)(...o))},[...e[24]||(e[24]=[l("img",{src:j},null,-1),v(" Удалить ",-1)])]),l("div",{class:"edit controller-item",onClick:e[2]||(e[2]=(...o)=>t(K)&&t(K)(...o))},[...e[25]||(e[25]=[l("img",{src:fe},null,-1),v(" Редактировать ",-1)])]),s(ve,{class:"change-status controller-item","dropdown-list":t(D),onChange:e[3]||(e[3]=o=>console.log("Status changed to: ",o))},{default:d(()=>[...e[26]||(e[26]=[l("img",{src:ge},null,-1),v(" Изменить статус ",-1)])]),_:1},8,["dropdown-list"])]),key:"0"}:void 0]),1024),s(me,{style:{"margin-top":"20px"},data:t(a),columns:t(r),onRowDblclick:e[6]||(e[6]=o=>t(T)(t(y))),onSelectionChanged:t(f),ref_key:"mainTableRef",ref:c},null,8,["data","columns","onSelectionChanged"])])]),s(Y,{"header-title":"Парковочный объект: “ТЦ Ромашка”",tabs:t(N),"inner-width":870,"close-on-overlay-click":!1,onOverlayClick:e[12]||(e[12]=o=>t(T)(t(P))),onSaveClick:t(J),onCloseClick:e[13]||(e[13]=o=>t(b)(t(y))),ref_key:"clientEditorRef",ref:y},{data:d(()=>[l("form",De,[e[31]||(e[31]=l("h3",null,"Данные о компании",-1)),l("div",he,[s(H,{name:"name",modelValue:t(p).name,"onUpdate:modelValue":e[7]||(e[7]=o=>t(p).name=o),label:"Название"},null,8,["modelValue"]),s(H,{name:"phone",modelValue:t(p).phone,"onUpdate:modelValue":e[8]||(e[8]=o=>t(p).phone=o),label:"Телефон"},null,8,["modelValue"]),s(H,{name:"email",modelValue:t(p).email,"onUpdate:modelValue":e[9]||(e[9]=o=>t(p).email=o),label:"E-mail"},null,8,["modelValue"]),s(H,{name:"address",modelValue:t(p).address,"onUpdate:modelValue":e[10]||(e[10]=o=>t(p).address=o),label:"Адрес"},null,8,["modelValue"]),l("div",Ae,[e[30]||(e[30]=l("label",null,[v("Статус "),l("br"),v(" клиента")],-1)),s(F,{modelValue:t(p).status,"onUpdate:modelValue":e[11]||(e[11]=o=>t(p).status=o),options:t(p).statusOptions,name:"client-status"},null,8,["modelValue","options"])])])])]),contact:d(()=>[e[34]||(e[34]=l("h3",null,"Контактные лица",-1)),l("div",Ne,[s(ke,{style:{"margin-top":"20px"},columns:t(O),data:t($),ref_key:"contactsTableRef",ref:A},null,8,["columns","data"]),e[32]||(e[32]=l("div",{class:"comment-popup"},[l("input",{type:"text",placeholder:"Ваш комментарий"})],-1))]),s(w,{class:"btn-filled",onClick:t(ne),style:{"margin-top":"20px"}},{default:d(()=>[...e[33]||(e[33]=[v(" Добавить новый контакт ",-1)])]),_:1},8,["onClick"])]),_:1},8,["tabs","onSaveClick"]),s(I,{ref_key:"savePopupRef",ref:P,"confirm-text":"Сохранить","cancel-text":"Не сохранять",onCancel:t(se),onConfirm:t(J)},{default:d(()=>[...e[35]||(e[35]=[l("h2",{class:"popup-title"},"Сохранить перед выходом?",-1),l("p",{class:"popup-text"},"Без сохранения все изменения будут потеряны!",-1)])]),_:1},8,["onCancel","onConfirm"]),s(I,{ref_key:"deleteSinglePopupRef",ref:E,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:e[14]||(e[14]=o=>t(b)(t(E))),onCancel:e[15]||(e[15]=o=>t(b)(t(E)))},{default:d(()=>[...e[36]||(e[36]=[l("h2",{class:"popup-title"}," Удалить объект? ",-1)])]),_:1},512),s(Se,{ref_key:"saveNotifyRef",ref:M},{default:d(()=>[...e[37]||(e[37]=[l("img",{src:ye},null,-1),l("span",null,"Изменения сохранены",-1)])]),_:1},512),s(Y,{tabs:t(h),"custom-class":"mass-editor-modal","header-title":"Выбрано: 3",onSaveClick:e[17]||(e[17]=o=>console.log("Changes saved!")),onCloseClick:e[18]||(e[18]=o=>t(b)(t(V))),ref_key:"massEditorRef",ref:V},{edit:d(()=>[l("form",Oe,[e[40]||(e[40]=l("h3",null,"Редактирование выбранных объектов",-1)),e[41]||(e[41]=l("div",{class:"d-flex"},[l("span",{class:"fields-label"},"Параметр"),l("span",{class:"fields-label"},"До изменения"),l("span",{class:"fields-label"},"После изменения")],-1)),(Z(!0),L(te,null,_e(t(x),(o,W)=>(Z(),L("div",{class:"fields-row",key:W},[s(F,{options:t(_)},null,8,["options"]),s(F,{options:t(_)},null,8,["options"]),s(F,{options:t(_)},null,8,["options"]),l("button",{type:"button",class:"delete-row",onClick:Be=>t(x).splice(W,1)},[...e[38]||(e[38]=[l("img",{src:j},null,-1)])],8,Ie)]))),128)),l("button",{type:"button",class:"add-fields-btn",onClick:e[16]||(e[16]=(...o)=>t(Q)&&t(Q)(...o))},[...e[39]||(e[39]=[l("img",{src:ee},null,-1),v(" Добавить изменения ",-1)])])])]),_:1},8,["tabs"]),s(ce,{"table-columns":t(i),onChange:e[19]||(e[19]=o=>t(ae)(o,t(n),t(c))),ref_key:"tableSettingsRef",ref:R},null,8,["table-columns"]),s(I,{ref_key:"deleteSelectedPopupRef",ref:S,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:t(oe),onCancel:e[20]||(e[20]=o=>t(b)(t(S)))},{default:d(()=>[l("h2",Le,[e[42]||(e[42]=v(" Удалить клиентов? ",-1)),e[43]||(e[43]=l("br",null,null,-1)),v(" "+le(t(C)),1)])]),_:1},8,["onConfirm"])],64))}},We=Te(Ze,[["__scopeId","data-v-7b25d3a5"]]);export{We as default};
