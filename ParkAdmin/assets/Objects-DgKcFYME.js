import{g as N,_ as h,a as pe,u as fe,T as be,P as ve,b as ge,d as ee,c as Z,e as ye,f as Se,h as Ce,D as ke,i as we,l as te,j as Ee,k as Te,F as y}from"./FilterSortDate-DwA6o7ns.js";import{C as Re,_ as Ve}from"./CalculatedSummary-DAMxnVYl.js";import{B as je,_ as Pe}from"./BottomNotify-CK2KQ3FM.js";import{B as R}from"./BaseButton-BJgVlfLN.js";import{_ as $e,a as xe,F as x}from"./FilterSortSearch-BEreCfIb.js";import{c as S,o as V}from"./modal-DRTCzFhK.js";import{s as Me,x as A,e as c,i as L,y as Fe,_ as Ue,c as z,a as l,b as n,w as d,g as le,z as oe,u as t,A as Oe,F as se,o as M,d as b,t as ne,j as _e}from"./index-Ye-EomIF.js";const B=Me("objects",{state:()=>({mainTable:{columns:[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,width:30},{field:"name",title:"Название",headerSort:!1,width:140},{field:"geopos",title:"Геопозиция",headerSort:!1,width:150},{field:"country",title:"Страна",headerSort:!1,width:100},{field:"city",title:"Город",headerSort:!1,width:100},{field:"address",title:"Адрес",headerSort:!1,width:200},{field:"acquiring",title:"Эквайринг",headerSort:!1,width:200},{field:"status",title:"Статус",headerSort:!1,width:160},{field:"commission",title:"Комиссия",headerSort:!1},{field:"lang",title:"Язык",headerSort:!1},{field:"currency",title:"Валюта",headerSort:!1},{field:"pp",title:"%PP",headerSort:!1,width:75}],content:[{id:1,name:"ТЦ Ромашка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:670,average_sum:340},{id:2,name:"ТЦ Метрополис",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",acquiring:"Сбербанк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:7e3,average_length:265,average_sum:775},{id:3,name:"ТЦ Таганка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:11e3,average_length:560,average_sum:900},{id:4,name:"ТЦ Лорисы",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:8e3,average_length:654,average_sum:340},{id:5,name:"ТЦ Долиной",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",acquiring:"Сбербанк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:1e4,average_length:344,average_sum:775},{id:6,name:"ТЦ Хата",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:455,average_sum:900}]},modalTable:{tabs:[{name:"data",label:"Данные о компании"},{name:"contact",label:"Контактные лица"}],fields:{clients:["ООО Ромашка","ООО Название","ООО НеНазвание","ООО Крутое","ООО ЪЫБа"],client:"ООО “Сириус”",object:"ТЦ Ромашка",status:"Активен",statusOptions:[{label:"Активен",value:"Активен"},{label:"Отключен",value:"Отключен"}],domain:"my-company.com",fiscalServices:[{label:"Атол онлайн",value:"Атол онлайн"},{label:"AFАтол оffлайн",value:"AFАтол оffлайн"}],fiscalService:"Атол онлайн",checkEmail:"promkrep@yandex.ru",countries:[{label:"Россия",value:"Россия"},{label:"Туркменистан",value:"Туркменистан"}],country:"Россия",address:"Москва, ул. Ленина,1",timeZones:[{label:"(GMT+3) Москва",value:"(GMT+3) Москва"},{label:"(GMT+5) Ашхабад",value:"(GMT+5) Ашхабад"}],timeZone:"(GMT+3) Москва",currencies:[{label:"Руб",value:"rub"},{label:"Доллар США",value:"usd"}],currency:"rub",langs:[{label:"Ru",value:"ru"},{label:"EN",value:"en"}],lang:"ru"},columns:[{field:"name",title:"ФИО",width:121,headerSort:!1,editor:"input"},{field:"position",title:"Должность",width:98,headerSort:!1,editor:"input"},{field:"phone",title:"Телефон",headerSort:!1,editor:"input",editorParams:{mask:"+*****************",selectContents:!0,maskAutoFill:!0}},{field:"email",title:"E-mail",headerSort:!1,editor:"input"},{title:"",field:"actions",hozAlign:"center",headerSort:!1,width:30,formatter:function(){return`
                  <div class="table-action">
                    <img src="${N}" class="delete-btn" />
                  </div>
              `},cellClick:function(u,a){const p=a.getRow();u.target.classList.contains("delete-btn")&&p.delete()}}],content:[{name:"Петров Виктор Сидорович",position:"Ген.директор",phone:"+7 (495) 123-45-67",email:"petrov.vs@centercity.ru"},{name:"Сидорова Анна Михайловна",position:"Главный инженер",phone:"+7 (916) 100-20-30",email:"sidorova.am@city.ru"},{name:"Ковалев Игорь Дмитриевич",position:"Менеджер парковки",phone:"+7 (495) 123-45-67",email:"kovalev.id@centercity.ru"}]},massEditor:{params:[{label:"Геопозиция",value:"geopos"},{label:"Страна",value:"country"},{label:"Город",value:"city"},{label:"Адрес",value:"address"},{label:"Эквайринг",value:"acquiring"},{label:"Статус",value:"status"},{label:"Комиссия",value:"commission"},{label:"Язык",value:"lang"},{label:"Валюта",value:"currency"},{label:"%PP",value:"pp"}]}})});function Ae(){return{applyFiltersToColumns:(a,p,m)=>p.map(i=>i.field==="name"?{...i,headerClickPopup(){const r=document.createElement("div");return A(h,{onSelectSortOrder(){m(a,"name")}}).mount(r),r}}:i.field==="geopos"?{...i,headerClickPopup(){const r=document.createElement("div");return A(h,{onSelectSortOrder(){m(a,"geopos")}}).mount(r),r}}:i.field==="country"?{...i,headerClickPopup(){const r=document.createElement("div");return A(pe,{onSelectSortOrder(){m(a,"country")},onSelectCompareState(){m(a,"country")},onSelectDate(){m(a,"country")},onSelectDateRange(){m(a,"country")}}).mount(r),r}}:i.field==="city"?{...i,headerClickPopup(){const r=document.createElement("div");return A($e,{onSelectSortOrder(){m(a,"city")},dropdownItems:[{name:"Пенза"},{name:"Мосва"},{name:"Самара"},{name:"Екатеринбург"},{name:"Кемерово"}],onSelectCheckbox(){m(a,"city")}}).mount(r),r}}:i)}}function Ne(){const u=B(),a=c(null),p=c(null),m=c(null),i=c(null),r=c(null),v=c(u.modalTable.tabs),w=L(()=>u.modalTable.fields),C=u.modalTable.columns,k=u.modalTable.content,g=c(!1);return u.$subscribe((U,j)=>{g.value=!0}),{objectEditorRef:a,contactsTableRef:p,savePopupRef:m,saveNotifyRef:i,deleteSinglePopupRef:r,objectEditorTabs:v,objectEditorFields:w,objectEditorTableColumns:C,objectEditorTableContent:k,objectHasEdited:g,saveConfirmClick:()=>{S(m.value),V(i.value),setTimeout(()=>S(i.value),3e3)},cancelSaveClick:()=>{S(m.value),S(a.value)},addModalTableRow:()=>{p.value.getTable()?.addRow({id:Date.now(),name:"",status:"new"}),u.modalTable.content.push({id:Date.now(),name:"",status:"new"})}}}function De(u){const a=B(),p=c(null),m=c([{name:"edit",label:"Массовое редактирование"}]),i=c(a.massEditor.params),r=Fe([{}]);return{massEditorRef:p,massEditorTabs:m,massEditorParams:i,massEditorFields:r,openMassEditor:()=>u.openMassEditor(p),addMassEditorFieldsRow:()=>u.addMassEditorFieldsRow(r)}}function qe(){const u=B(),a=fe(),{hasSelection:p,selectedCount:m,selectedRows:i,selectedRowsName:r,changeTableSettings:v,addResetFilterBtn:w}=a,C=c(null),k=L(()=>u.mainTable.columns),g=L(()=>u.mainTable.content),$=c(null),F=k.value.filter(f=>f.formatter!=="rowSelection").map(f=>({field:f.field,title:f.title})),E=c(null),U=c([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:j}=Ae();u.mainTable.columns=j(C,k.value,w);const D=Ne(),q=De(a),O=c([]),T=c(!1),_=()=>a.deselectAll(C),P=()=>a.deleteSelected(C,()=>S(E.value)),H=()=>V(E.value),I=f=>{a.onSelectionChanged(f,"name"),T.value&&s()},s=()=>{T.value=!0,O.value=i.value.map(f=>({name:f.name,average_length:f.average_length,average_sum:f.average_sum,total_sum:f.total_sum}))};return{objectsStore:u,mainTableRef:C,tableHeader:k,tableContent:g,tableSettingsHeader:F,hasSelection:p,selectedCount:m,selectedRows:i,selectedRowsName:r,deleteSelectedPopupRef:E,tableSettingsRef:$,statusOptionsList:U,showCalculatedSummary:T,summaryItems:O,...D,...q,onSelectionChanged:I,deselectAll:_,deleteSelected:P,changeTableSettings:v,calculateSummaryItems:s,openDeletePopup:H}}const He={class:"page"},Ie={class:"page-content"},Ge={action:"#"},Ze={class:"fields-group"},ze={class:"field-outer"},Le={class:"fields-group"},Be={class:"field-outer"},Je={class:"fields-group"},Ke={class:"field-outer"},Qe={class:"field-outer"},We={class:"fields-group"},Xe={class:"field-outer"},Ye={class:"field-outer"},he={action:"#"},et=["onClick"],tt={class:"popup-title"},lt={__name:"Objects",setup(u){const{objectsStore:a,mainTableRef:p,tableHeader:m,tableContent:i,tableSettingsHeader:r,hasSelection:v,selectedCount:w,selectedRowsName:C,deleteSelectedPopupRef:k,deleteSinglePopupRef:g,savePopupRef:$,saveNotifyRef:F,tableSettingsRef:E,statusOptionsList:U,showCalculatedSummary:j,summaryItems:D,massEditorRef:q,massEditorTabs:O,massEditorParams:T,massEditorFields:_,objectEditorRef:P,contactsTableRef:H,objectEditorTabs:I,objectEditorFields:s,objectEditorTableColumns:f,objectEditorTableContent:ae,objectHasEdited:ie,onSelectionChanged:re,deselectAll:G,openDeletePopup:J,deleteSelected:de,saveConfirmClick:K,cancelSaveClick:ue,openMassEditor:Q,addModalTableRow:me,addMassEditorFieldsRow:W,changeTableSettings:ce,calculateSummaryItems:X}=qe();return(ot,e)=>(M(),z(se,null,[l("main",He,[n(be,null,{default:d(()=>[n(R,{class:"btn-filled"},{default:d(()=>[...e[29]||(e[29]=[b("Объекты",-1)])]),_:1})]),_:1}),l("div",Ie,[t(j)?oe("",!0):(M(),le(ve,{key:0},Oe({right:d(()=>[n(R,{class:"btn-filled add-element-btn",onClick:e[5]||(e[5]=o=>t(V)(t(P)))},{default:d(()=>[...e[35]||(e[35]=[l("img",{src:te},null,-1),b(" Добавить новый объект ",-1)])]),_:1}),n(R,{class:"small-btn",onClick:e[6]||(e[6]=o=>t(V)(t(E)))},{default:d(()=>[...e[36]||(e[36]=[l("img",{src:Ee},null,-1)])]),_:1}),n(R,{class:"small-btn"},{default:d(()=>[...e[37]||(e[37]=[l("img",{src:Te},null,-1)])]),_:1})]),_:2},[t(v)==!0?{name:"left",fn:d(()=>[l("div",{class:"selected-count controller-item",onClick:e[0]||(e[0]=(...o)=>t(G)&&t(G)(...o))},[l("span",null,"Выбрано: "+ne(t(w)),1),n(R,{class:"btn-filled"},{default:d(()=>[...e[30]||(e[30]=[l("img",{src:Se},null,-1)])]),_:1})]),l("div",{class:"delete-row controller-item",onClick:e[1]||(e[1]=(...o)=>t(J)&&t(J)(...o))},[...e[31]||(e[31]=[l("img",{src:N},null,-1),b(" Удалить ",-1)])]),l("div",{class:"edit controller-item",onClick:e[2]||(e[2]=(...o)=>t(Q)&&t(Q)(...o))},[...e[32]||(e[32]=[l("img",{src:Ce},null,-1),b(" Редактировать ",-1)])]),n(ke,{class:"change-status controller-item","dropdown-list":t(U),onChange:e[3]||(e[3]=o=>console.log("Status changed to: ",o))},{default:d(()=>[...e[33]||(e[33]=[l("img",{src:we},null,-1),b(" Изменить статус ",-1)])]),_:1},8,["dropdown-list"]),l("div",{class:"summary controller-item",onClick:e[4]||(e[4]=(...o)=>t(X)&&t(X)(...o))},[...e[34]||(e[34]=[l("img",{src:Ve},null,-1),b(" Сумма ",-1)])])]),key:"0"}:void 0]),1024)),t(j)?(M(),le(Re,{key:1,"selected-text":`${t(w)} объектов`,items:t(D),onReset:e[7]||(e[7]=o=>(j.value=!1,t(G)()))},null,8,["selected-text","items"])):oe("",!0),n(ge,{style:{"margin-top":"20px"},data:t(i),columns:t(m),onRowDblclick:e[8]||(e[8]=o=>t(V)(t(P))),onSelectionChanged:t(re),ref_key:"mainTableRef",ref:p},null,8,["data","columns","onSelectionChanged"])])]),n(ee,{"header-title":"Парковочный объект: “ТЦ Ромашка”",tabs:t(I),"inner-width":870,"close-on-overlay-click":!1,"disabled-save-btn":!t(ie),onOverlayClick:e[21]||(e[21]=o=>t(V)(t($))),onSaveClick:t(K),onCloseClick:e[22]||(e[22]=o=>t(S)(t(P))),ref_key:"objectEditorRef",ref:P},{data:d(()=>[l("form",Ge,[e[44]||(e[44]=l("h3",null,"Данные о компании",-1)),l("div",Ze,[n(x,{items:t(s).clients,name:"client",modelValue:t(s).client,"onUpdate:modelValue":e[9]||(e[9]=o=>t(s).client=o),label:"Клиент"},null,8,["items","modelValue"]),n(x,{name:"object",modelValue:t(s).object,"onUpdate:modelValue":e[10]||(e[10]=o=>t(s).object=o),label:"Объект"},null,8,["modelValue"]),l("div",ze,[e[38]||(e[38]=l("label",null,"Статус",-1)),n(y,{modelValue:t(s).status,"onUpdate:modelValue":e[11]||(e[11]=o=>t(s).status=o),options:t(s).statusOptions},null,8,["modelValue","options"])]),n(x,{name:"domain",modelValue:t(s).domain,"onUpdate:modelValue":e[12]||(e[12]=o=>t(s).domain=o),label:"Домен объекта"},null,8,["modelValue"])]),l("div",Le,[l("div",Be,[e[39]||(e[39]=l("label",null,[b("Фиск. "),l("br"),b(" сервис")],-1)),n(y,{modelValue:t(s).fiscalService,"onUpdate:modelValue":e[13]||(e[13]=o=>t(s).fiscalService=o),options:t(s).fiscalServices,name:"fiscal-service"},null,8,["modelValue","options"])]),n(x,{name:"check-email",modelValue:t(s).checkEmail,"onUpdate:modelValue":e[14]||(e[14]=o=>t(s).checkEmail=o),label:"E-mail <br> для чеков"},null,8,["modelValue"])]),l("div",Je,[l("div",Ke,[e[40]||(e[40]=l("label",null,"Страна",-1)),n(y,{modelValue:t(s).country,"onUpdate:modelValue":e[15]||(e[15]=o=>t(s).country=o),options:t(s).countries,name:"country"},null,8,["modelValue","options"])]),n(x,{name:"address",modelValue:t(s).address,"onUpdate:modelValue":e[16]||(e[16]=o=>t(s).address=o),label:"Адрес"},null,8,["modelValue"]),l("div",Qe,[e[41]||(e[41]=l("label",null,"Час. пояс",-1)),n(y,{modelValue:t(s).timeZone,"onUpdate:modelValue":e[17]||(e[17]=o=>t(s).timeZone=o),options:t(s).timeZones,name:"timezone"},null,8,["modelValue","options"])])]),l("div",We,[l("div",Xe,[e[42]||(e[42]=l("label",null,"Валюта",-1)),n(y,{modelValue:t(s).currency,"onUpdate:modelValue":e[18]||(e[18]=o=>t(s).currency=o),options:t(s).currencies,name:"currency"},null,8,["modelValue","options"])]),l("div",Ye,[e[43]||(e[43]=l("label",null,"Язык",-1)),n(y,{modelValue:t(s).lang,"onUpdate:modelValue":e[19]||(e[19]=o=>t(s).lang=o),options:t(s).langs,name:"lang"},null,8,["modelValue","options"])])])])]),contact:d(()=>[e[46]||(e[46]=l("h3",null,"Контактные лица",-1)),n(xe,{style:{"margin-top":"20px"},columns:t(f),data:t(ae),ref_key:"contactsTableRef",ref:H},null,8,["columns","data"]),n(R,{style:{"margin-top":"20px"},onClick:t(me)},{default:d(()=>[...e[45]||(e[45]=[b("Добавить",-1)])]),_:1},8,["onClick"])]),"sidebar-bottom":d(()=>[n(R,{class:"remove-object-btn",onClick:e[20]||(e[20]=o=>t(V)(t(g)))},{default:d(()=>[...e[47]||(e[47]=[l("img",{src:N},null,-1),b(" Удалить объект ",-1)])]),_:1})]),_:1},8,["tabs","disabled-save-btn","onSaveClick"]),n(Z,{ref_key:"savePopupRef",ref:$,"confirm-text":"Сохранить","cancel-text":"Не сохранять",onCancel:t(ue),onConfirm:t(K)},{default:d(()=>[...e[48]||(e[48]=[l("h2",{class:"popup-title"},"Сохранить перед выходом?",-1),l("p",{class:"popup-text"},"Без сохранения все изменения будут потеряны!",-1)])]),_:1},8,["onCancel","onConfirm"]),n(Z,{ref_key:"deleteSinglePopupRef",ref:g,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:e[23]||(e[23]=o=>t(S)(t(g))),onCancel:e[24]||(e[24]=o=>t(S)(t(g)))},{default:d(()=>[...e[49]||(e[49]=[l("h2",{class:"popup-title"}," Удалить объект? ",-1)])]),_:1},512),n(je,{ref_key:"saveNotifyRef",ref:F},{default:d(()=>[...e[50]||(e[50]=[l("img",{src:Pe},null,-1),l("span",null,"Изменения сохранены",-1)])]),_:1},512),n(ee,{tabs:t(O),"custom-class":"mass-editor-modal","header-title":"Выбрано: 3",onSaveClick:e[26]||(e[26]=o=>console.log("Changes saved!")),ref_key:"massEditorRef",ref:q},{edit:d(()=>[l("form",he,[e[53]||(e[53]=l("h3",null,"Редактирование выбранных объектов",-1)),e[54]||(e[54]=l("div",{class:"d-flex"},[l("span",{class:"fields-label"},"Параметр"),l("span",{class:"fields-label"},"До изменения"),l("span",{class:"fields-label"},"После изменения")],-1)),(M(!0),z(se,null,_e(t(_),(o,Y)=>(M(),z("div",{class:"fields-row",key:Y},[n(y,{options:t(T)},null,8,["options"]),n(y,{options:t(T)},null,8,["options"]),n(y,{options:t(T)},null,8,["options"]),l("button",{type:"button",class:"delete-row",onClick:st=>t(_).splice(Y,1)},[...e[51]||(e[51]=[l("img",{src:N},null,-1)])],8,et)]))),128)),l("button",{type:"button",class:"add-fields-btn",onClick:e[25]||(e[25]=(...o)=>t(W)&&t(W)(...o))},[...e[52]||(e[52]=[l("img",{src:te},null,-1),b(" Добавить изменения ",-1)])])])]),_:1},8,["tabs"]),n(ye,{"table-columns":t(r),onChange:e[27]||(e[27]=o=>t(ce)(o,t(a),t(p))),ref_key:"tableSettingsRef",ref:E},null,8,["table-columns"]),n(Z,{ref_key:"deleteSelectedPopupRef",ref:k,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:t(de),onCancel:e[28]||(e[28]=o=>t(S)(t(k)))},{default:d(()=>[l("h2",tt,[e[55]||(e[55]=b(" Удалить объекты ",-1)),e[56]||(e[56]=l("br",null,null,-1)),b(" "+ne(t(C)),1)])]),_:1},8,["onConfirm"])],64))}},ct=Ue(lt,[["__scopeId","data-v-845d37c6"]]);export{ct as default};
