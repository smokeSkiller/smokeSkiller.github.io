import{_ as A,f as R,u as H}from"./vue-3-slider-component-lab0IWlZ.js";import{T as Z}from"./TableModal-DR_FmA9s.js";import{B as U}from"./BaseButton-CNUrt7E6.js";import{F as v}from"./FormField-DFyU_dJ9.js";import{_ as b}from"./FormSelectField-DKGRwksg.js";import{_ as D}from"./SecondaryTable-8zNcad-4.js";import{_ as I,e as d,g as z,o as L,w as p,b as r,a as i,d as S,A as W,B as C,i as V,C as J}from"./index-iaVJZ9tw.js";import{c as g,o as P}from"./modal-DRTCzFhK.js";import{_ as K}from"./FilterSortSearch-SdFdygUQ.js";import{_ as Q}from"./FilterSortDate-CuMhXrGb.js";const X={action:"#"},Y={class:"fields-group"},_={class:"field-outer"},ee={class:"fields-group"},te={class:"field-outer"},le={class:"fields-group"},oe={class:"field-outer"},ae={class:"field-outer"},se={class:"fields-group"},ne={class:"field-outer"},ie={class:"field-outer"},de=Object.assign({inheritAttrs:!1},{__name:"ObjectsEditor",props:{headerTitle:String,tabs:Array,innerWidth:Number,closeOnOverlayClick:Boolean,disabledSaveBtn:Boolean,objectHasEdited:Boolean,objectEditorFields:Array,objectEditorTableColumns:Array,objectEditorTableContent:Array},emits:["overlay-click","save-click","close-click","add-modal-table-row","open-delete-popup"],setup(t,{expose:o,emit:u}){const a=u,s=d(null),n=d(null);return o({contactsTable:n,open:()=>s.value.open(),close:()=>s.value.close()}),(m,e)=>(L(),z(Z,{"header-title":t.headerTitle,tabs:t.tabs,"inner-width":t.innerWidth,"close-on-overlay-click":!1,"disabled-save-btn":!t.objectHasEdited,onOverlayClick:e[13]||(e[13]=l=>a("overlay-click")),onSaveClick:e[14]||(e[14]=l=>a("save-click")),onCloseClick:e[15]||(e[15]=l=>a("close-click")),ref_key:"objectEditorRef",ref:s},{data:p(()=>[i("form",X,[e[22]||(e[22]=i("h3",null,"Данные о компании",-1)),i("div",Y,[r(v,{items:t.objectEditorFields.clients,name:"client",modelValue:t.objectEditorFields.client,"onUpdate:modelValue":e[0]||(e[0]=l=>t.objectEditorFields.client=l),label:"Клиент"},null,8,["items","modelValue"]),r(v,{name:"object",modelValue:t.objectEditorFields.object,"onUpdate:modelValue":e[1]||(e[1]=l=>t.objectEditorFields.object=l),label:"Объект"},null,8,["modelValue"]),i("div",_,[e[16]||(e[16]=i("label",null,"Статус",-1)),r(b,{modelValue:t.objectEditorFields.status,"onUpdate:modelValue":e[2]||(e[2]=l=>t.objectEditorFields.status=l),options:t.objectEditorFields.statusOptions},null,8,["modelValue","options"])]),r(v,{name:"domain",modelValue:t.objectEditorFields.domain,"onUpdate:modelValue":e[3]||(e[3]=l=>t.objectEditorFields.domain=l),label:"Домен объекта"},null,8,["modelValue"])]),i("div",ee,[i("div",te,[e[17]||(e[17]=i("label",null,[S("Фиск. "),i("br"),S(" сервис")],-1)),r(b,{modelValue:t.objectEditorFields.fiscalService,"onUpdate:modelValue":e[4]||(e[4]=l=>t.objectEditorFields.fiscalService=l),options:t.objectEditorFields.fiscalServices,name:"fiscal-service"},null,8,["modelValue","options"])]),r(v,{name:"check-email",modelValue:t.objectEditorFields.checkEmail,"onUpdate:modelValue":e[5]||(e[5]=l=>t.objectEditorFields.checkEmail=l),label:"E-mail <br> для чеков"},null,8,["modelValue"])]),i("div",le,[i("div",oe,[e[18]||(e[18]=i("label",null,"Страна",-1)),r(b,{modelValue:t.objectEditorFields.country,"onUpdate:modelValue":e[6]||(e[6]=l=>t.objectEditorFields.country=l),options:t.objectEditorFields.countries,name:"country"},null,8,["modelValue","options"])]),r(v,{name:"address",modelValue:t.objectEditorFields.address,"onUpdate:modelValue":e[7]||(e[7]=l=>t.objectEditorFields.address=l),label:"Адрес"},null,8,["modelValue"]),i("div",ae,[e[19]||(e[19]=i("label",null,"Час. пояс",-1)),r(b,{modelValue:t.objectEditorFields.timeZone,"onUpdate:modelValue":e[8]||(e[8]=l=>t.objectEditorFields.timeZone=l),options:t.objectEditorFields.timeZones,name:"timezone"},null,8,["modelValue","options"])])]),i("div",se,[i("div",ne,[e[20]||(e[20]=i("label",null,"Валюта",-1)),r(b,{modelValue:t.objectEditorFields.currency,"onUpdate:modelValue":e[9]||(e[9]=l=>t.objectEditorFields.currency=l),options:t.objectEditorFields.currencies,name:"currency"},null,8,["modelValue","options"])]),i("div",ie,[e[21]||(e[21]=i("label",null,"Язык",-1)),r(b,{modelValue:t.objectEditorFields.lang,"onUpdate:modelValue":e[10]||(e[10]=l=>t.objectEditorFields.lang=l),options:t.objectEditorFields.langs,name:"lang"},null,8,["modelValue","options"])])])])]),contact:p(()=>[e[24]||(e[24]=i("h3",null,"Контактные лица",-1)),r(D,{style:{"margin-top":"20px"},columns:t.objectEditorTableColumns,data:t.objectEditorTableContent,ref_key:"objectContactsTableRef",ref:n},null,8,["columns","data"]),r(U,{style:{"margin-top":"20px"},onClick:e[11]||(e[11]=l=>a("add-modal-table-row"))},{default:p(()=>[...e[23]||(e[23]=[S("Добавить",-1)])]),_:1})]),"sidebar-bottom":p(()=>[r(U,{class:"remove-object-btn",onClick:e[12]||(e[12]=l=>a("open-delete-popup"))},{default:p(()=>[...e[25]||(e[25]=[i("img",{src:A},null,-1),S(" Удалить объект ",-1)])]),_:1})]),_:1},8,["header-title","tabs","inner-width","disabled-save-btn"]))}}),Ce=I(de,[["__scopeId","data-v-c46197da"]]),k=W("objects",{state:()=>({mainTable:{columns:[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,width:30},{field:"name",title:"Название",headerSort:!1,width:140},{field:"geopos",title:"Геопозиция",headerSort:!1,width:150},{field:"country",title:"Страна",headerSort:!1,width:100},{field:"city",title:"Город",headerSort:!1,width:100},{field:"address",title:"Адрес",headerSort:!1,width:200},{field:"acquiring",title:"Эквайринг",headerSort:!1,width:200},{field:"status",title:"Статус",headerSort:!1,width:160},{field:"commission",title:"Комиссия",headerSort:!1},{field:"lang",title:"Язык",headerSort:!1},{field:"currency",title:"Валюта",headerSort:!1},{field:"pp",title:"%PP",headerSort:!1,width:75}],content:[{id:1,name:"ТЦ Ромашка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:670,average_sum:340},{id:2,name:"ТЦ Метрополис",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",acquiring:"Сбербанк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:7e3,average_length:265,average_sum:775},{id:3,name:"ТЦ Таганка",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:11e3,average_length:560,average_sum:900},{id:4,name:"ТЦ Лорисы",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:8e3,average_length:654,average_sum:340},{id:5,name:"ТЦ Долиной",geopos:"Россия",country:"Россия",city:"Москва",address:"Большая Полянка, 31",acquiring:"Сбербанк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:15,total_sum:1e4,average_length:344,average_sum:775},{id:6,name:"ТЦ Хата",geopos:"Россия",country:"Россия",city:"Пенза",address:"Светлая, 13",acquiring:"Точка Банк",status:"Действующий",commission:"Включена",lang:"RU",currency:"Рубль",pp:10,total_sum:1e4,average_length:455,average_sum:900}]},modalTable:{tabs:[{name:"data",label:"Данные о компании"},{name:"contact",label:"Контактные лица"}],fields:{clients:["ООО Ромашка","ООО Название","ООО НеНазвание","ООО Крутое","ООО ЪЫБа"],client:"ООО “Сириус”",object:"ТЦ Ромашка",status:"Активен",statusOptions:[{label:"Активен",value:"Активен"},{label:"Отключен",value:"Отключен"}],domain:"my-company.com",fiscalServices:[{label:"Атол онлайн",value:"Атол онлайн"},{label:"AFАтол оffлайн",value:"AFАтол оffлайн"}],fiscalService:"Атол онлайн",checkEmail:"promkrep@yandex.ru",countries:[{label:"Россия",value:"Россия"},{label:"Туркменистан",value:"Туркменистан"}],country:"Россия",address:"Москва, ул. Ленина,1",timeZones:[{label:"(GMT+3) Москва",value:"(GMT+3) Москва"},{label:"(GMT+5) Ашхабад",value:"(GMT+5) Ашхабад"}],timeZone:"(GMT+3) Москва",currencies:[{label:"Руб",value:"rub"},{label:"Доллар США",value:"usd"}],currency:"rub",langs:[{label:"Ru",value:"ru"},{label:"EN",value:"en"}],lang:"ru"},columns:[{field:"name",title:"ФИО",width:121,headerSort:!1,editor:"input"},{field:"position",title:"Должность",width:98,headerSort:!1,editor:"input"},{field:"phone",title:"Телефон",headerSort:!1,editor:"input",editorParams:{mask:"+*****************",selectContents:!0,maskAutoFill:!0}},{field:"email",title:"E-mail",headerSort:!1,editor:"input"},{title:"",field:"actions",hozAlign:"center",headerSort:!1,width:30,formatter:function(){return`
                  <div class="table-action">
                    <img src="${A}" class="delete-btn" />
                  </div>
              `},cellClick:function(t,o){const u=o.getRow();t.target.classList.contains("delete-btn")&&u.delete()}}],content:[{name:"Петров Виктор Сидорович",position:"Ген.директор",phone:"+7 (495) 123-45-67",email:"petrov.vs@centercity.ru"},{name:"Сидорова Анна Михайловна",position:"Главный инженер",phone:"+7 (916) 100-20-30",email:"sidorova.am@city.ru"},{name:"Ковалев Игорь Дмитриевич",position:"Менеджер парковки",phone:"+7 (495) 123-45-67",email:"kovalev.id@centercity.ru"}]},massEditor:{params:[{label:"Геопозиция",value:"geopos"},{label:"Страна",value:"country"},{label:"Город",value:"city"},{label:"Адрес",value:"address"},{label:"Эквайринг",value:"acquiring"},{label:"Статус",value:"status"},{label:"Комиссия",value:"commission"},{label:"Язык",value:"lang"},{label:"Валюта",value:"currency"},{label:"%PP",value:"pp"}]}})});function re(){return{applyFiltersToColumns:(o,u,a)=>u.map(s=>s.field==="name"?{...s,headerClickPopup(){const n=document.createElement("div");return C(R,{onSelectSortOrder(){a(o,"name")}}).mount(n),n}}:s.field==="geopos"?{...s,headerClickPopup(){const n=document.createElement("div");return C(R,{onSelectSortOrder(){a(o,"geopos")}}).mount(n),n}}:s.field==="country"?{...s,headerClickPopup(){const n=document.createElement("div");return C(Q,{onSelectSortOrder(){a(o,"country")},onSelectCompareState(){a(o,"country")},onSelectDate(){a(o,"country")},onSelectDateRange(){a(o,"country")}}).mount(n),n}}:s.field==="city"?{...s,headerClickPopup(){const n=document.createElement("div");return C(K,{onSelectSortOrder(){a(o,"city")},dropdownItems:[{name:"Пенза"},{name:"Мосва"},{name:"Самара"},{name:"Екатеринбург"},{name:"Кемерово"}],onSelectCheckbox(){a(o,"city")}}).mount(n),n}}:s)}}function ue(){const t=k(),o=d(null),u=d(null),a=d(null),s=d(null),n=d(null),m=d(t.modalTable.tabs),e=V(()=>t.modalTable.fields),l=t.modalTable.columns,f=t.modalTable.content,E=d(!1);return t.$subscribe((j,h)=>{E.value=!0}),{objectEditorRef:o,objectContactsTableRef:u,savePopupRef:a,saveNotifyRef:s,deleteSinglePopupRef:n,objectEditorTabs:m,objectEditorFields:e,objectEditorTableColumns:l,objectEditorTableContent:f,objectHasEdited:E,saveConfirmClick:()=>{g(a.value),P(s.value),setTimeout(()=>g(s.value),3e3)},cancelSaveClick:()=>{g(a.value),g(o.value)},addModalTableRow:j=>{j.getTable()?.addRow({id:Date.now(),name:"",status:"new"}),t.modalTable.content.push({name:"",position:"",phone:"",email:""})}}}function ce(t){const o=k(),u=d(null),a=d([{name:"edit",label:"Массовое редактирование"}]),s=d(o.massEditor.params),n=J([{}]);return{massEditorRef:u,massEditorTabs:a,massEditorParams:s,massEditorFields:n,openMassEditor:()=>t.openMassEditor(u),addMassEditorFieldsRow:()=>t.addMassEditorFieldsRow(n)}}function Fe(){const t=k(),o=H(),{hasSelection:u,selectedCount:a,selectedRows:s,selectedRowsName:n,changeTableSettings:m,addResetFilterBtn:e}=o,l=d(null),f=V(()=>t.mainTable.columns),E=V(()=>t.mainTable.content),w=d(null),T=f.value.filter(c=>c.formatter!=="rowSelection").map(c=>({field:c.field,title:c.title})),y=d(null),j=d([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:h}=re();t.mainTable.columns=h(l,f.value,e);const $=ue(),x=ce(o),O=d([]),F=d(!1),q=()=>o.deselectAll(l),N=()=>o.deleteSelected(l,()=>g(y.value)),B=()=>P(y.value),G=c=>{o.onSelectionChanged(c,"name"),F.value&&M()},M=()=>{F.value=!0,O.value=s.value.map(c=>({name:c.name,average_length:c.average_length,average_sum:c.average_sum,total_sum:c.total_sum}))};return{objectsStore:t,mainTableRef:l,tableHeader:f,tableContent:E,tableSettingsHeader:T,hasSelection:u,selectedCount:a,selectedRows:s,selectedRowsName:n,deleteSelectedPopupRef:y,tableSettingsRef:w,statusOptionsList:j,showCalculatedSummary:F,summaryItems:O,...$,...x,onSelectionChanged:G,deselectAll:q,deleteSelected:N,changeTableSettings:m,calculateSummaryItems:M,openDeletePopup:B}}export{Ce as O,k as a,Fe as u};
