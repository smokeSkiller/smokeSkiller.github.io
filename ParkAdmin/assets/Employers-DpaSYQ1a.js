import{_ as D}from"./plus-icon-lxHPDhbU.js";import{c as B,u as U,P as F,d as I,e as H,f as j,a as _,b as q,_ as W}from"./vue-3-slider-component-DVLLiOr3.js";import{B as Y,_ as Z}from"./BottomNotify-BTbGL-ds.js";import{T as z}from"./TableModal-p6TpcjEn.js";import{T as G}from"./CustomOpenIndicator-BQQZUi6w.js";import{B as w}from"./BaseButton-BUPZcaam.js";import{F as V}from"./FormField-5cKzPise.js";import{_ as J}from"./FormSelectField-BrAB1vmC.js";import{x as K,y as P,e as C,i as M,_ as Q,c as X,a,b as n,w as m,u as t,F as h,o as ee,d as y,B as L}from"./index-BWF_qH93.js";import{_ as te}from"./FilterSortSearch-CQoBWqkz.js";import{_ as oe}from"./FilterSortDate-CPNclfv2.js";import{c as k,o as x}from"./modal-DRTCzFhK.js";const le="data:image/svg+xml,%3csvg%20width='16'%20height='16'%20viewBox='0%200%2016%2016'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M2.66406%204.66666L6.19739%207.31665C7.26406%208.11666%208.73073%208.11665%209.7974%207.31665L13.3307%204.66663'%20stroke='%23343434'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20d='M8%2012.6666H4C2.89543%2012.6666%202%2011.7712%202%2010.6666V5.33331C2%204.22874%202.89543%203.33331%204%203.33331H12C13.1046%203.33331%2014%204.22874%2014%205.33331V7.99998'%20stroke='%23343434'%20stroke-linecap='round'/%3e%3cpath%20d='M10.6641%2011.3334L13.9974%2011.3334M13.9974%2011.3334L12.6641%2012.6667M13.9974%2011.3334L12.6641%2010'%20stroke='%23343434'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/svg%3e",N=K("employers",{state:()=>({mainTable:{columns:[{field:"id",title:"ID пользователя",headerSort:!1},{field:"name",title:"ФИО",headerSort:!1},{field:"position",title:"Должность",headerSort:!1},{field:"role",title:"Роль",headerSort:!1,formatter:p=>`
                <div class="role-select">
                  <span class="dropdown-toggle">
                    ${p._cell.value}
                    <svg width="7" height="6" viewBox="0 0 7 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M3.46094 6L6.92504 0H-0.00316405L3.46094 6Z" fill="#A49A9A"/>
                    </svg>
                  </span>
                </div>
              `,cellClick:(p,r)=>{if(!p.target.closest(".dropdown-toggle"))return;const d=r.getElement(),i=r.getValue(),s=document.getElementById("tabulator-role-dropdown");s&&s.remove();const l=document.createElement("ul");l.className="tabulator-role-dropdown",["Менеджер","Администратор"].forEach(b=>{const S=document.createElement("li");S.className="dropdown-item",S.innerHTML=`
                <label>
                  <span class="name">${b}</span>
                  <input type="radio" name="role" value="${b}" 
                    ${i===b?"checked":""} />
                  <div class="box">
                    <svg width="8" height="6" viewBox="0 0 8 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.5 3.35714L2.6 5.5L7.5 0.5" stroke="white" stroke-linecap="round" stroke-linejoin="round"/></svg>
                  </div>
                </label>
              `,l.appendChild(S)}),document.body.appendChild(l);const v=d.getBoundingClientRect(),c=window.scrollY||document.documentElement.scrollTop,$=window.innerHeight-v.bottom,f=l.offsetHeight||100;let T;$<f&&v.top>f?T=v.top+c-f-4:T=v.bottom+c+2,l.style.top=`${T}px`,l.style.left=`${v.right-l.offsetWidth}px`,l.querySelectorAll("input").forEach(b=>{b.addEventListener("change",S=>{const R=S.target.value;r.setValue(R)})});const u=b=>{!l.contains(b.target)&&!d.contains(b.target)&&(l.remove(),document.removeEventListener("click",u))};setTimeout(()=>{document.addEventListener("click",u)},0)}}],content:[{id:1,name:"Иванов Иван Иванович",position:"Старший менеджер",role:"Менеджер"},{id:2,name:"Петров Петр Петрович",position:"Технический директор",role:"Администратор"},{id:3,name:"Воронина Маргарита Сергеевна",position:"Менеджер парковки",role:"Менеджер"},{id:4,name:"Иванов Иван Иванович",position:"Старший менеджер",role:"Менеджер"},{id:5,name:"Петров Петр Петрович",position:"Технический директор",role:"Администратор"},{id:6,name:"Воронина Маргарита Сергеевна",position:"Менеджер парковки",role:"Менеджер"}]},editor:{tabs:[{name:"data",label:"Общая информация"}],fields:{name:"Петров Сергей Иванович",email:"username@mail.ru",phone:"+7 (999) 999-00-00",position:"Менеджер парковки",role:"Менеджер",roleOptions:[{label:"Менеджер",value:"Менеджер"},{label:"Администратор",value:"Администратор"}]}}})});function ne(){return{applyFiltersToColumns:(r,g,d)=>g.map(i=>i.field==="name"?{...i,headerClickPopup(){const s=document.createElement("div");return P(B,{onSelectSortOrder(){d(r,"name")}}).mount(s),s}}:i.field==="geopos"?{...i,headerClickPopup(){const s=document.createElement("div");return P(B,{onSelectSortOrder(){d(r,"geopos")}}).mount(s),s}}:i.field==="country"?{...i,headerClickPopup(){const s=document.createElement("div");return P(oe,{onSelectSortOrder(){d(r,"country")},onSelectCompareState(){d(r,"country")},onSelectDate(){d(r,"country")},onSelectDateRange(){d(r,"country")}}).mount(s),s}}:i.field==="city"?{...i,headerClickPopup(){const s=document.createElement("div");return P(te,{onSelectSortOrder(){d(r,"city")},dropdownItems:[{name:"Пенза"},{name:"Мосва"},{name:"Самара"},{name:"Екатеринбург"},{name:"Кемерово"}],onSelectCheckbox(){d(r,"city")}}).mount(s),s}}:i)}}function se(){const p=N(),r=C(null),g=C(null),d=C(null),i=C(null),s=C(null),l=C(null),E=C(p.editor.tabs),v=M(()=>p.editor.fields),c=C(!1);return p.$subscribe((u,b)=>{c.value=!0}),{employerEditorRef:r,contactsTableRef:g,savePopupRef:d,saveNotifyRef:i,sendEmailPopupRef:s,deleteSinglePopupRef:l,employerEditorTabs:E,employerEditorFields:v,employerHasEdited:c,saveConfirmClick:()=>{k(d.value),x(i.value),setTimeout(()=>k(i.value),3e3)},cancelSaveClick:()=>{k(d.value),k(r.value)},addModalTableRow:()=>{g.value.getTable()?.addRow({id:Date.now(),name:"",status:"new"}),p.modalTable.content.push({id:Date.now(),name:"",status:"new"})}}}function ae(){const p=N(),r=U(),{addResetFilterBtn:g,changeTableSettings:d}=r,i=C(null),s=M(()=>p.mainTable.columns),l=M(()=>p.mainTable.content),E=C(null),v=s.value.filter(f=>f.formatter!=="rowSelection").map(f=>({field:f.field,title:f.title})),{applyFiltersToColumns:c}=ne();p.mainTable.columns=c(i,s.value,g);const $=se();return{employersStore:p,mainTableRef:i,tableHeader:s,tableContent:l,tableSettingsHeader:v,tableSettingsRef:E,...$,changeTableSettings:d}}const re={class:"page"},ie={class:"page-content"},de={action:"#"},me={class:"fields-group"},pe={class:"field-outer"},ue={__name:"Employers",setup(p){const{employersStore:r,mainTableRef:g,tableHeader:d,tableContent:i,tableSettingsHeader:s,deleteSinglePopupRef:l,savePopupRef:E,saveNotifyRef:v,sendEmailPopupRef:c,tableSettingsRef:$,employerEditorRef:f,employerEditorTabs:T,employerEditorFields:u,employerHasEdited:b,saveConfirmClick:S,cancelSaveClick:R,changeTableSettings:O}=ae();return(A,e)=>(ee(),X(h,null,[a("main",re,[n(G,null,{default:m(()=>[n(w,{class:"btn-filled"},{default:m(()=>[...e[20]||(e[20]=[y("Сотрудники",-1)])]),_:1}),n(w,{onClick:e[0]||(e[0]=o=>t(L).push("/roles"))},{default:m(()=>[...e[21]||(e[21]=[y("Управление ролями",-1)])]),_:1}),n(w,{onClick:e[1]||(e[1]=o=>t(L).push("/myprofile"))},{default:m(()=>[...e[22]||(e[22]=[y("Мой профиль",-1)])]),_:1}),n(w,{onClick:e[2]||(e[2]=o=>t(L).push("/general"))},{default:m(()=>[...e[23]||(e[23]=[y("Общие настройки сервиса",-1)])]),_:1})]),_:1}),a("div",ie,[n(F,null,{left:m(()=>[...e[24]||(e[24]=[])]),right:m(()=>[n(w,{class:"btn-filled add-element-btn",onClick:e[3]||(e[3]=o=>t(x)(t(f)))},{default:m(()=>[...e[25]||(e[25]=[a("img",{src:D},null,-1),y(" Добавить сотрудника ",-1)])]),_:1}),n(w,{class:"small-btn",onClick:e[4]||(e[4]=o=>t(x)(t($)))},{default:m(()=>[...e[26]||(e[26]=[a("img",{src:_},null,-1)])]),_:1}),n(w,{class:"small-btn"},{default:m(()=>[...e[27]||(e[27]=[a("img",{src:q},null,-1)])]),_:1})]),_:1}),n(I,{style:{"margin-top":"20px"},id:"employers-table",data:t(i),columns:t(d),onRowDblclick:e[5]||(e[5]=o=>t(x)(t(f))),onSelectionChanged:A.onSelectionChanged,ref_key:"mainTableRef",ref:g},null,8,["data","columns","onSelectionChanged"])])]),n(z,{"header-title":"ID пользователя 145463",tabs:t(T),"inner-width":870,"close-on-overlay-click":!1,"disabled-save-btn":!t(b),onOverlayClick:e[13]||(e[13]=o=>t(x)(t(E))),onSaveClick:t(S),onCloseClick:e[14]||(e[14]=o=>t(k)(t(f))),ref_key:"employerEditorRef",ref:f},{data:m(()=>[a("form",de,[e[30]||(e[30]=a("h3",null,"Данные о компании",-1)),a("div",me,[n(V,{name:"name",modelValue:t(u).name,"onUpdate:modelValue":e[6]||(e[6]=o=>t(u).name=o),label:"ФИО","label-width":"90"},null,8,["modelValue"]),n(V,{name:"email",modelValue:t(u).email,"onUpdate:modelValue":e[7]||(e[7]=o=>t(u).email=o),label:"E-mail","label-width":"90"},null,8,["modelValue"]),n(V,{name:"phone",modelValue:t(u).phone,"onUpdate:modelValue":e[8]||(e[8]=o=>t(u).phone=o),label:"Телефон","label-width":"90"},null,8,["modelValue"]),n(V,{name:"position",modelValue:t(u).position,"onUpdate:modelValue":e[9]||(e[9]=o=>t(u).position=o),label:"Должность","label-width":"90"},null,8,["modelValue"]),a("div",pe,[e[28]||(e[28]=a("label",{style:{width:"90px"}},"Роль",-1)),n(J,{modelValue:t(u).role,"onUpdate:modelValue":e[10]||(e[10]=o=>t(u).role=o),options:t(u).statusOptions},null,8,["modelValue","options"])]),n(w,{class:"btn-filled send-password-btn",type:"button",onClick:e[11]||(e[11]=o=>t(x)(t(c)))},{default:m(()=>[...e[29]||(e[29]=[a("img",{src:le},null,-1),a("span",null,"Отправить пароль на почту",-1)])]),_:1})])])]),"sidebar-bottom":m(()=>[n(w,{class:"remove-object-btn",onClick:e[12]||(e[12]=o=>t(x)(t(l)))},{default:m(()=>[...e[31]||(e[31]=[a("img",{src:W},null,-1),y(" Удалить сотрудника ",-1)])]),_:1})]),_:1},8,["tabs","disabled-save-btn","onSaveClick"]),n(H,{ref_key:"savePopupRef",ref:E,"confirm-text":"Сохранить","cancel-text":"Не сохранять",onCancel:t(R),onConfirm:t(S)},{default:m(()=>[...e[32]||(e[32]=[a("h2",{class:"popup-title"},"Сохранить перед выходом?",-1),a("p",{class:"popup-text"},"Без сохранения все изменения будут потеряны!",-1)])]),_:1},8,["onCancel","onConfirm"]),n(H,{ref_key:"sendEmailPopupRef",ref:c,"confirm-text":"Отправить","cancel-text":"Отменить",onCancel:e[15]||(e[15]=o=>t(k)(t(c))),onConfirm:e[16]||(e[16]=o=>t(k)(t(c)))},{default:m(()=>[...e[33]||(e[33]=[a("h2",{class:"popup-title"},[y("Отправить пароль на "),a("br"),y(" Username@mail.ru?")],-1)])]),_:1},512),n(H,{ref_key:"deleteSinglePopupRef",ref:l,"confirm-style":"red","confirm-text":"Удалить","cancel-text":"Отменить",onConfirm:e[17]||(e[17]=o=>t(k)(t(l))),onCancel:e[18]||(e[18]=o=>t(k)(t(l)))},{default:m(()=>[...e[34]||(e[34]=[a("h2",{class:"popup-title"},[y(" Удалить сотрудника? "),a("br"),y(" Петров Сергей Иванович? ")],-1)])]),_:1},512),n(Y,{ref_key:"saveNotifyRef",ref:v},{default:m(()=>[...e[35]||(e[35]=[a("img",{src:Z},null,-1),a("span",null,"Изменения сохранены",-1)])]),_:1},512),n(j,{"table-columns":t(s),onChange:e[19]||(e[19]=o=>t(O)(o,t(r),t(g))),ref_key:"tableSettingsRef",ref:$},null,8,["table-columns"])],64))}},xe=Q(ue,[["__scopeId","data-v-d2d148ff"]]);export{xe as default};
