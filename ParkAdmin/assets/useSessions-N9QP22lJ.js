import{m as p,n as h}from"./note-icon--KIhCtrW.js";import{B as H,f as k,u as q}from"./vue-3-slider-component-lab0IWlZ.js";import{c as M,o as K}from"./modal-DRTCzFhK.js";import{e as r,g as U,o as B,w as C,a as e,n as G,u as y,d,A as J,B as f,C as Q,i as E}from"./index-iaVJZ9tw.js";import{_ as j}from"./FilterSortDate-CuMhXrGb.js";const X="/ParkAdmin/assets/session-CFWKBI7c.png",Y={class:"content-inner"},Z={class:"top-box"},R={class:"box"},_={class:"row"},ee={class:"d-flex align-items-center"},te={class:"row"},se={class:"d-flex align-items-center"},ce=Object.assign({inheritAttrs:!1},{__name:"SessionsDetails",props:{innerWidth:Number,customClass:String},emits:["open-payment-details"],setup(i,{expose:s,emit:u}){const n=r(null),o=u;return s({open:()=>n.value.open(),close:()=>n.value.close()}),(l,t)=>(B(),U(H,{"inner-width":i.innerWidth,"custom-class":i.customClass,ref_key:"sessionDetailsRef",ref:n},{header:C(()=>[t[4]||(t[4]=e("h2",{class:"title"},"Сессия №1665423547316996",-1)),e("button",{class:"close-btn",onClick:t[0]||(t[0]=c=>y(M)(n.value))},[...t[3]||(t[3]=[e("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M10.668 10.6667L21.3346 21.3334",stroke:"black","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M21.332 10.6667L10.6654 21.3334",stroke:"black","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),body:C(()=>[e("div",Y,[e("div",Z,[e("div",{class:"img",style:G({"background-image":`url(${y(X)})`})},null,4),t[5]||(t[5]=e("div",{class:"content"},[e("p",null,[d(" Номер ТС: "),e("b",null,"М969ММ777")]),e("p",{class:"d-flex"},[e("span",{style:{width:"145px"}},[d("Объект: "),e("b",null,"ТЦ “Мега”")]),e("button",{class:"icon link-icon"},[e("img",{src:p})])]),e("p",{class:"d-flex"},[e("span",{style:{width:"145px"}},[d("Клиент: "),e("b",null,"ООО Ирбис")]),e("button",{class:"icon link-icon"},[e("img",{src:p})])]),e("p",null,[d("Статус: "),e("b",null,"Оплачена")]),e("p",null,[d("Продолжительность: "),e("b",null,"02:44:26")])],-1))]),t[16]||(t[16]=e("div",{class:"box"},[e("h4",null,"Въезд:"),e("div",{class:"d-flex justify-content-between w-100"},[e("p",null,"Дата и время"),e("p",null,[e("b",null,"14.05.24, 20:30:11")])])],-1)),e("div",R,[t[14]||(t[14]=e("h4",null,"Оплата:",-1)),e("div",_,[t[9]||(t[9]=e("p",null,"04.11.2025, 15:50:31, Банковская карта ****1234",-1)),e("div",ee,[t[7]||(t[7]=e("p",null,[e("b",null,"450 ₽")],-1)),t[8]||(t[8]=e("button",{class:"icon copy-icon"},[e("img",{src:h})],-1)),e("button",{class:"icon link-icon",onClick:t[1]||(t[1]=c=>o("open-payment-details"))},[...t[6]||(t[6]=[e("img",{src:p},null,-1)])])])]),t[15]||(t[15]=e("div",{class:"row row-error"},[e("p",null,"04.11.2025, 15:54:17, Банковская карта ****5990"),e("div",{class:"d-flex align-items-center"},[e("p",null,[e("b",null,"450 ₽, ошибка оплаты")])])],-1)),e("div",te,[t[13]||(t[13]=e("p",null,"04.11.2025, 16:03:14, Касса №2009",-1)),e("div",se,[t[11]||(t[11]=e("p",null,[e("b",null,"450 ₽")],-1)),t[12]||(t[12]=e("button",{class:"icon copy-icon"},[e("img",{src:h})],-1)),e("button",{class:"icon link-icon",onClick:t[2]||(t[2]=c=>o("open-payment-details"))},[...t[10]||(t[10]=[e("img",{src:p},null,-1)])])])])]),t[17]||(t[17]=e("div",{class:"box"},[e("h4",null,"Выезд:"),e("div",{class:"d-flex justify-content-between w-100"},[e("p",null,"Дата и время"),e("p",null,[e("b",null,"14.05.24, 20:30:11")])])],-1))])]),_:1},8,["inner-width","custom-class"]))}}),D=J("sessions",{state:()=>({mainTable:{columns:[{formatter:"rowSelection",titleFormatter:"rowSelection",hozAlign:"center",headerSort:!1,width:30},{field:"id",title:"№ Сессии",headerSort:!1,width:150},{field:"object-name",title:"Объект",headerSort:!1,width:140},{field:"vehicle-number",title:"Номер ТС",headerSort:!1,width:150},{field:"enter-time",title:"Время въезда",headerSort:!1},{field:"exit-time",title:"Время выезда",headerSort:!1},{field:"duration",title:"Длительность",headerSort:!1,width:135,formatter:function(i){const s=Number(i.getValue());if(!s||isNaN(s))return"—";const u=Math.floor(s/3600),n=Math.floor(s%3600/60),o=s%60,l=t=>t.toString().padStart(2,"0");return`${l(u)}:${l(n)}:${l(o)}`}},{field:"total",title:"Сумма",headerSort:!1,width:200,formatter:function(i){return`${i.getValue().toLocaleString("ru-RU",{minimumFractionDigits:2,maximumFractionDigits:2}).replace(/,/g,".")} ₽`}},{field:"status",title:"Статус",headerSort:!1,width:160,formatter:function(i){const s=i.getValue();return{paid:'<span class="status status-paid">Оплачена</span>',active:'<span class="status status-active">Активна</span>',canceled:'<span class="status status-canceled">Отменена</span>'}[s]??s}}],content:[{id:1,"object-name":"ТЦ Ромашка","vehicle-number":"У 888 ХХ 777","enter-time":"15.05.24 12:01:05","exit-time":"15.05.24 14:45:31",duration:5400,status:"paid",total:450},{id:2,"object-name":"БЦ Оазис","vehicle-number":"М 969 ММ 777","enter-time":"16.05.24 08:15:00","exit-time":"-",duration:1e3,status:"active",total:600},{id:3,"object-name":"ТЦ Мега","vehicle-number":"У 888 ХХ 777","enter-time":"15.05.24 12:01:05","exit-time":"15.05.24 14:45:31",duration:1200,status:"canceled",total:500},{id:4,"object-name":"ТЦ Ромашка","vehicle-number":"У 888 ХХ 777","enter-time":"15.05.24 12:01:05","exit-time":"15.05.24 14:45:31",duration:2400,status:"paid",total:450},{id:5,"object-name":"БЦ Оазис","vehicle-number":"М 969 ММ 777","enter-time":"16.05.24 08:15:00","exit-time":"-",duration:1500,status:"active",total:400}]},massEditor:{params:[{label:"№ Сессии",value:"session-id"},{label:"Объект",value:"object-name"},{label:"Номер ТС",value:"vehicle-number"},{label:"Время въезда",value:"enter-time"},{label:"Время выезда",value:"exit-time"},{label:"Длительность",value:"duration"},{label:"Сумма",value:"total"},{label:"Статус",value:"status"}]}})});function ne(){return{applyFiltersToColumns:(s,u,n)=>u.map(o=>o.field==="id"?{...o,headerClickPopup(){const l=document.createElement("div");return f(k,{onSelectSortOrder(){n(s,"id")}}).mount(l),l}}:o.field==="object-name"?{...o,headerClickPopup(){const l=document.createElement("div");return f(k,{onSelectSortOrder(){n(s,"object-name")}}).mount(l),l}}:o.field==="enter-time"?{...o,headerClickPopup(){const l=document.createElement("div");return f(j,{onSelectSortOrder(){n(s,"enter-time")},onSelectCompareState(){n(s,"enter-time")},onSelectDate(){n(s,"enter-time")},onSelectDateRange(){n(s,"enter-time")}}).mount(l),l}}:o.field==="exit-time"?{...o,headerClickPopup(){const l=document.createElement("div");return f(j,{onSelectSortOrder(){n(s,"exit-time")},onSelectCompareState(){n(s,"exit-time")},onSelectDate(){n(s,"exit-time")},onSelectDateRange(){n(s,"exit-time")}}).mount(l),l}}:o)}}function le(i){const s=D(),u=r(null),n=r([{name:"edit",label:"Массовое редактирование"}]),o=r(s.massEditor.params),l=Q([{}]);return{massEditorRef:u,massEditorTabs:n,massEditorParams:o,massEditorFields:l,openMassEditor:()=>i.openMassEditor(u),addMassEditorFieldsRow:()=>i.addMassEditorFieldsRow(l)}}function de(){const i=D(),s=q(),{hasSelection:u,selectedCount:n,selectedRows:o,selectedRowsName:l,changeTableSettings:t,addResetFilterBtn:c}=s,m=r(null),v=E(()=>i.mainTable.columns),A=E(()=>i.mainTable.content),$=r(null),P=r(null);r(null);const g=document.querySelectorAll(".pagination li");g&&g.forEach(a=>{a.addEventListenter("click",()=>{console.log("Item:",a)})});const N=r(null),V=v.value.filter(a=>a.formatter!=="rowSelection").map(a=>({field:a.field,title:a.title})),b=r(null),I=r([{value:"active",title:"Действующий"},{value:"stopped",title:"Приостановлен"},{value:"disabled",title:"Неактивный"},{value:"status-1",title:"Статус 1"},{value:"status-2",title:"Статус 2"}]),{applyFiltersToColumns:L}=ne();i.mainTable.columns=L(m,v.value,c);const O=le(s),w=r([]),S=r(!1),F=()=>s.deselectAll(m),T=()=>s.deleteSelected(m,()=>M(b.value)),W=()=>K(b.value),z=a=>{s.onSelectionChanged(a,"id"),S.value&&x()},x=()=>{S.value=!0,w.value=o.value.map(a=>({name:a["object-name"],average_length:a.duration,average_sum:a.total,total_sum:a.total}))};return{sessionsStore:i,mainTableRef:m,tableHeader:v,tableContent:A,tableSettingsHeader:V,sessionDetailsRef:$,paymentDetailsRef:P,hasSelection:u,selectedCount:n,selectedRows:o,selectedRowsName:l,deleteSelectedPopupRef:b,tableSettingsRef:N,statusOptionsList:I,showCalculatedSummary:S,summaryItems:w,...O,onSelectionChanged:z,deselectAll:F,deleteSelected:T,changeTableSettings:t,calculateSummaryItems:x,openDeletePopup:W}}export{ce as _,de as u};
